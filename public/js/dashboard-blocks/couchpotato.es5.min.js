"use strict";(function(n){n.fn.couchpotato=function(t){var i=n.extend({block:this,apiKey:this.data("couchpotato-apikey"),baseUrl:this.data("couchpotato-url")},t),r={initialize:function(){i.block.find(".fa-refresh").on("click",function(){r.refresh(!1)});i.block.find(".fa-search").on("click",r.searchWantedMovies);r.refresh(!0)},refresh:function(t){t||(i.block.isLoading(),i.block.find(".item").remove());n.ajax({url:r.url("media.list"),dataType:"json",success:function(t){n.each(t.movies,function(n,r){var u=i.block.find("a.clone").clone();u.removeClass("clone").addClass("item");u.attr({href:"/portal/couchpotato/movie/"+r._id,"data-fancybox":"couchpotato","data-fancybox-type":"iframe",title:r.info.tagline});n===t.movies.length-1&&u.removeClass("hidden_not_important");u.find(".title").html(r.title);u.find(".subtitle").html(r.info.tagline);u.css("background-image","url('"+r.info.images.poster+"')");u.attr("title",r.title);u.prependTo(i.block.find(".panel-body"))})},complete:function(){t||i.block.isLoading("hide")}})},searchWantedMovies:function(){showAlert("success","Initiating Couchpotato movie search");n.ajax({url:r.url("movie.searcher.full_search"),dataType:"json"})},url:function(n){return i.baseUrl+"api/"+i.apiKey+"/"+n+"/"}};r.initialize()}})(jQuery);