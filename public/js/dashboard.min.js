"use strict";function initializePlugins(){$(".sysinfo, .hardware, .harddisks, .processes").phpsysinfo();$(".devices").devices();$(".transmission").transmission();$(".movies, .episodes, .albums, .couchpotato").gallery();$(".nowplaying").nowplaying();$(".sickrage").sickrage();$(".couchpotato").couchpotato();$(".motion").motion();speedtest=$(".speedtest").speedtest();opcache=$(".opcache").opcache();$(".youless").youless();pihole=$(".pihole").pihole();snmp=$(".snmp").snmp();$(".verisure").verisure();$(".time:not(.delayed)").each(function(){initializeTinyTimer($(this))})}function initializeDashboardEventHandlers(){$(".toggle-collapse, .panel-heading h4").click(function(){var n=$(this).closest(".panel");n.find(".toggle-collapse:visible").length!==0&&(n.find(".toggle-collapse").toggleClass("fa-minus fa-plus"),n.find(".panel-body:eq(0)").toggleClass("hidden-xs"),n.hasClass("gallery")?n.css("height",n.find(".panel-body:eq(0)").hasClass("hidden-xs")?"auto":"379px"):opcache!==!1&&n.hasClass("opcache")?opcache.initializeChart():pihole!==!1&&n.hasClass("pihole")?pihole.initializeChart():speedtest!==!1&&n.hasClass("speedtest")&&speedtest.initUI(),n.find(".tab-content").length||n.find(".panel-body").length||n.find(".list-group").toggleClass("hidden-xs"))});$("footer .toggle-all").click(function(){$(".fa-"+($(this).hasClass("fa-expand")?"plus":"minus")).trigger("click");$(this).toggleClass("fa-expand fa-compress")})}function initializeTinyTimer(n){var t=new Date;t.setSeconds(t.getSeconds()-Math.floor(n.html()));n.tinyTimer({from:t,format:"%d days %0h:%0m:%0s"}).fadeIn()}(function(n){n.fn.couchpotato=function(t){var i=n.extend({block:this,apiKey:this.data("couchpotato-apikey"),baseUrl:this.data("base-url"),couchpotatoBaseUrl:this.data("couchpotato-url")},t),r={initialize:function(){if(i.block.length!==0){i.block.find(".fa-sync").on("click",r.refresh);i.block.find(".fa-search").on("click",r.searchWantedMovies)}},refresh:function(){i.block.isLoading();i.block.find(".item").remove();n.ajax({url:r.url("media.list"),dataType:"json",success:function(t){n.each(t.movies,function(n,t){var r=i.block.find("a.clone").clone();r.removeClass("clone").addClass("item");r.attr({href:i.baseUrl+"couchpotato/movie/"+t._id,"data-fancybox":"couchpotato","data-type":"iframe",title:t.info.tagline});n===0&&r.removeClass("hidden_not_important");r.find(".title").html(t.title);r.find(".subtitle").html(t.info.tagline);r.css("background-image","url('"+t.info.images.poster+"')");r.attr("title",t.title);r.appendTo(i.block.find(".panel-body"))})},complete:function(){i.block.isLoading("hide")}})},searchWantedMovies:function(){showAlert("success","Initiating Couchpotato movie search");n.ajax({url:r.url("movie.searcher.full_search"),dataType:"json"})},url:function(n){return i.couchpotatoBaseUrl+"api/"+i.apiKey+"/"+n+"/"}};r.initialize()}})(jQuery),function(n){n.fn.devices=function(t){var i=n.extend({block:this,updateInterval:this.data("device-state-interval")*1e3,updateIntervalId:-1},t),r={initialize:function(){if(i.block.length!==0){i.block.on("click",".fa-sync",function(){clearInterval(i.updateIntervalId);i.updateIntervalId=setInterval(function(){self.checkstates(self)},i.updateInterval);r.checkstates(i.block)});i.block.on("click",".btn-danger",function(){var t="Wake <span>"+n(this).closest("li").find("div:first").html().trim()+"<\/span>?";openConfirmDialog(t,[{mac:n(this).data("mac")}],function(){r.wol(n(this))})});i.block.on("click",".btn-success",function(){var t="Shutdown <span>"+n(this).closest("li").find("div:first").html().trim()+"<\/span>?";openConfirmDialog(t,[{"shutdown-user":n(this).data("shutdown-user"),"shutdown-password":n(this).data("shutdown-password"),ip:n(this).data("ip")}],function(){r.doShutdown(n(this))})});i.block.on("click",".webtemp",function(){n.getJSON("devices/webtemp/"+n(this).data("deviceid"),function(t){n.fancybox.open(t)})});r.checkstates()}},checkstates:function(t){t=typeof t=="undefined"?this:t;var r=new Date;clearInterval(i.updateIntervalId);i.updateIntervalId=setInterval(function(){t.checkstates(t)},i.updateInterval);i.block.find(".devicestate").each(function(){var f=n(this),t=n(this).find("span.fa"),i=n(this).data("ip"),u=n("ul.nav li[data-ip='"+i+"'");u.find("a").bind("click",!1);n(this).removeClass("btn-danger btn-success");n(this).addClass("disabled");t.removeClass("fa-power-off");t.addClass("fa-sync fa-spin"),function(t,i,u,f){n.getJSON("devices/state/"+f+"/"+r.getTime(),"",function(n){u.removeClass("fa-sync fa-spin");u.addClass("fa-power-off");t.removeClass("disabled");t.data("shutdown-method")==="none"&&t.addClass("disabled");n.state?(i.removeClass("disabled"),t.parent().find(".hypervadmin").removeClass("disabled"),i.find("a").unbind("click",!1)):(i.addClass("disabled"),t.parent().find(".hypervadmin").addClass("disabled"));t.addClass("btn-"+(n.state?"success":"danger"))})}(f,u,t,i)})},wol:function(t){if(n.fancybox.close(),t.attr("id")==="confirm-yes"){var i=t.closest("div").find("h2 span").html().trim();n.get("devices/wol/"+t.closest("div").data("mac"),function(n){showAlert("success","Magic packet send to: "+n)}(i))}},doShutdown:function(t){if(n.fancybox.close(),t.attr("id")==="confirm-yes"){var i=t.closest("div"),u=i.data("shutdown-user"),f=i.data("shutdown-password"),e=i.data("ip"),r=i.closest("div").find("h2 span").html().trim();n.get("devices/shutdown/"+e+"/"+u+"/"+f,function(n){var t="danger",i="Shutdown command failed for: "+r;n==="true"&&(t="success",i="Shutdown command send to: "+r);showAlert(t,i)})}}};return r.initialize(),r}}(jQuery),function(n){n.fn.gallery=function(t){this.each(function(){var i=n.extend({block:n(this),rotateInterval:n(this).data("rotate-interval")*1e3,rotateIntervalId:-1},t),r={initialize:function(){i.block.length!==0&&(i.rotateIntervalId=setInterval(function(){r.rotateGallery("right")},i.rotateInterval),i.block.find(".fa-chevron-left, .fa-chevron-right").click(function(){clearInterval(i.rotateIntervalId);r.rotateGallery(n(this).hasClass("fa-chevron-left")?"left":"right");i.rotateIntervalId=setInterval(function(){r.rotateGallery("right")},i.rotateInterval)}))},rotateGallery:function(n){if(i.block.find(".panel-body:visible").length){var t=i.block.find(".item:visible").index(),r=n==="right"?1:-1,u=i.block.find(".item:eq("+(t+r)+")").length===1?t+r:0;t!==u&&i.block.find(".item:eq("+t+")").fadeOut("fast",function(){i.block.find(".item:eq("+u+")").fadeIn("fast").css("display","block")})}}};r.initialize()})}}(jQuery),function(n){n.fn.hypervadmin=function(t){var i=n.extend({block:this,vm:{stateEnabed:2,stateDisabed:3,toggleStateBaseURL:this.find("#vms").data("togglestate-baseurl")},sites:{stateEnabed:1,stateDisabed:3,toggleStateBaseURL:this.find("#sites").data("togglestate-baseurl")}},t),r={initialize:function(){if(i.block.length!==0){i.block.on("click",".togglestate:visible",function(){var t=n(this).closest(".panel").attr("id"),i=n(this).attr("href"),u=n(this).closest("tr").find("td:eq(1)").html();return openConfirmDialog("Are you sure?",[],function(){n.fancybox.close();n(this).attr("id")==="confirm-yes"&&r.toggleState(i,u,t)}),!1});i.block.find(".fa-sync").on("click",function(){switch(n(this).closest("a").attr("href")){case"#vms":r.refreshVMs(!0);break;case"#sites":r.refreshSites(!0)}})}},toggleState:function(t,u,f){i.block.isLoading();n.ajax({url:t,success:function(){showAlert("success","State toggled for "+(f==="vm"?"VM":"site")+": "+u);f==="vms"?r.refreshVMs():r.refreshSites()}})},refreshVMs:function(t){t=typeof t=="undefined"?!1:t;t&&i.block.isLoading();n.getJSON("getVMs",function(t){var r=i.block.find("#vms tbody");r.find("tr:not(.hidden)").remove();t.sort(function(n,t){return n.Name<t.Name?1:-1});n.each(t,function(n,t){var u=i.block.find("#vms tr.hidden").clone(),f=t.State===i.vm.stateEnabed?i.vm.stateDisabed:i.vm.stateEnabed;u.find(".name").html(t.Name);u.find(".load .percent").html(t.CPULoad+"%");u.find(".load .progress-bar").css("width",t.CPULoad+"%");u.find(".cores").html(t.CoresAmount);u.find(".ram").html(t.MemoryTotal+" "+t.MemoryAllocationUnits);u.find(".mac").html(t.MAC);u.find(".ontime").html(t.GetOnTimeFormatted);u.find(".actions a").attr("href",i.vm.toggleStateBaseURL+t.Name+"/"+f).addClass("btn-"+(t.State===i.vm.stateEnabed?"success":"danger"));u.removeClass("hidden");u.prependTo(r)})}).always(function(){i.block.isLoading("hide")})},refreshSites:function(t){t=typeof t=="undefined"?!1:t;t&&i.block.isLoading();n.getJSON("getSites",function(t){var r=i.block.find("#sites tbody");r.find("tr:not(.hidden)").remove();t.sort(function(n,t){return n.Name<t.Name?1:-1});n.each(t,function(n,t){var u=i.block.find("#sites tr.hidden").clone(),f=t.State===i.sites.stateEnabed?i.sites.stateDisabed:i.sites.stateEnabed;u.find(".name").html(t.Name);u.find(".actions a").attr("href",i.sites.toggleStateBaseURL+t.Name+"/"+f).addClass("btn-"+(t.State===i.sites.stateEnabed?"success":"danger"));u.removeClass("hidden");u.prependTo(r)})}).always(function(){i.block.isLoading("hide")})}};return r.initialize(),r};n(".hypervadmin").length&&n(".hypervadmin").hypervadmin()}(jQuery),function(n){n.fn.motion=function(t){var i=n.extend({block:this,baseUri:this.data("baseuri"),updateInterval:this.data("motion-interval")*1e3,updateIntervalId:-1},t),r={initialize:function(){if(i.block.length!==0){i.block.on("click",".fa-sync",function(){clearInterval(i.updateIntervalId);i.updateIntervalId=setInterval(function(){r.refreshImage();r.refreshModifiedTime()},i.updateInterval);r.refreshImage();r.refreshModifiedTime()});i.updateIntervalId=setInterval(function(){r.refreshImage();r.refreshModifiedTime()},i.updateInterval)}},refreshImage:function(){var n=i.block.find("a"),t=n.css("background-image"),r=t.split("?t=");n.css("background-image",r[0]+"?t="+Date.now()+'")')},refreshModifiedTime:function(){n.ajax({url:i.baseUri+"motion/modifiedTime",success:function(n){i.block.find(".subtitle").text(n)}})}};return r.initialize(),r}}(jQuery),function(n){n.fn.nowplaying=function(t){this.each(function(){var i=n.extend({block:n(this),updateInterval:n(this).data("nowplaying-intveral")*1e3,updateIntervalId:-1,subsonic:{loading:!1,url:n(this).data("subsonic-url"),password:n(this).data("subsonic-password"),username:n(this).data("subsonic-username"),timeout:5e3},kodi:{loading:!1,url:n(this).data("kodi-url"),urlJSON:n(this).data("kodi-url")+"/jsonrpc",password:n(this).data("kodi-password"),username:n(this).data("kodi-username"),timeout:5e3}},t),r={initialize:function(){i.block.find(".fa-sync").click(function(){r.nowPlaying()});i.block.find(".fa-chevron-left, .fa-chevron-right").click(function(){r.rotate(n(this).hasClass("fa-chevron-left")?"left":"right")});r.nowPlaying(!0)},nowPlaying:function(t){t=typeof t=="undefined"?!1:t;t||n(".nowplaying").isLoading();r.setInterval();i.block.find(".panel-heading button.fa-chevron-left, .panel-heading button.fa-chevron-right").addClass("disabled");i.block.find(".player.nothing-playing").hide();i.block.find(".player:not(.nothing-playing)").remove();r.subsonic.nowPlaying();r.kodi.nowPlaying();var u=window.setInterval(function(){t||i.kodi.loading!==!1||i.subsonic.loading!==!1||(n(".nowplaying").isLoading("hide"),clearInterval(u))},100)},nowPlayingCallback:function(){var n,t;i.kodi.loading===!1&&i.subsonic.loading===!1&&(n=i.block.find(".player:not(.nothing-playing)").length,n>0?i.block.find(".player.nothing-playing").hide():i.block.find(".player.nothing-playing").show(),n<=1?i.block.find(".panel-heading button.fa-chevron-left, .panel-heading button.fa-chevron-right").addClass("disabled"):i.block.find(".panel-heading button.fa-chevron-left, .panel-heading button.fa-chevron-right").removeClass("disabled"),t=i.block.find(".player:visible").hasClass("kodi")?"Kodi":"Subsonic",i.block.find("h4").html(t))},setInterval:function(){clearInterval(i.updateIntervalId);i.updateIntervalId=setInterval(function(){i.block.find(".player:not(.nothing-playing)").remove();r.subsonic.nowPlaying();r.kodi.nowPlaying()},i.updateInterval)},rotate:function(n){var t=i.block.find(".player:visible").index(),f=n==="right"?1:-1,r=1,u=i.block.find(".player:eq("+(t+f)+")");u.length!==1||u.hasClass("nothing-playing")?u.hasClass("nothing-playing")&&(r=i.block.find(".player").length-1):r=t+f;t!==r&&i.block.find(".player:eq("+t+")").fadeOut("fast",function(){i.block.find(".player:eq("+r+")").fadeIn("fast",function(){var n=i.block.find(".player:visible").hasClass("kodi")?"Kodi":"Subsonic";i.block.find("h4").html(n)}).css("display","block")})},createPlayer:function(t){var r=i.block.find(".player.nothing-playing").clone(),u=r.find("#nowplaying_detail").attr("id","nowplaying_detail_"+t.index);r.removeClass("nothing-playing");r.addClass(t.type);r.find(".item .image").css("background-image","url("+t.bgImage+")").parent().attr({title:n(this).attr("title"),href:"#nowplaying_detail_"+t.index});r.find(".title").html(t.title);r.find(".subtitle").html(t.subtitle);u.find("h4").html(t.title);u.find(".track").html(t.track);u.find(".album").html(t.album);u.find(".year").html(t.year);u.find(".genre").html(t.genre);u.find(".duration").html(t.duration);u.find(".bitrate").html(t.bitRate)+" kb/s";u.find(".playcount").html(t.playCount);u.find(".lastplayed").html(t.lastplayed+" minutes ago");i.block.find(".player:not(.nothing-playing):visible").length!==0?r.hide():r.show();r.appendTo(i.block.find(".panel-body"))},subsonic:{nowPlaying:function(){i.subsonic.loading=!0;n.ajax({url:r.subsonic.getURL("getNowPlaying"),timeout:i.subsonic.timeout,success:function(t){var i=n(t).find("entry");i.length!==0&&i.each(function(t){var i=r.subsonic.getURL("getCoverArt",{id:n(this).attr("coverArt")}),u=Math.floor(n(this).attr("duration")/60)+":"+n(this).attr("duration")%60;r.createPlayer({type:"subsonic",index:t,bgImage:i,title:n(this).attr("artist"),subtitle:n(this).attr("title"),track:n(this).attr("track"),album:n(this).attr("album"),genre:n(this).attr("genre"),duration:u,bitrate:n(this).attr("bitRate"),playCount:n(this).attr("playCount"),lastPlayed:n(this).attr("minutesAgo")})})},complete:function(){i.subsonic.loading=!1;r.nowPlayingCallback()}})},getSalt:function(){return Math.random().toString(36).substring(7)},getURL:function(t,u){var f=r.subsonic.getSalt(),o=SparkMD5.hash(i.subsonic.password+f),e=i.subsonic.url+"rest/"+t+".view?u="+i.subsonic.username+"&t="+o+"&s="+f+"&v=1.14.0&c=chell";return n.each(u,function(n,t){e+="&"+n+"="+t}),e}},kodi:{nowPlaying:function(){i.kodi.loading=!0;var t=r.kodi.getPlayerId();typeof t!="undefined"&&n.ajax({url:i.kodi.urlJSON,type:"POST",async:!1,contentType:"application/json",data:JSON.stringify({id:"getnowplaying",jsonrpc:"2.0",method:"Player.GetItem",params:{properties:["title","showtitle","artist","thumbnail"],playerid:t}}),timeout:i.kodi.timeout,beforeSend:function(n){n.setRequestHeader("Authorization","Basic "+btoa(i.kodi.username+":"+i.kodi.password))},success:function(t){if(n.trim(t.result.item.title)!==""){var i=t.result.item.title,u="";typeof t.result.item.showtitle!="undefined"?i=t.result.item.showtitle:typeof t.result.item.artist!="undefined"&&(i=t.result.item.artist,u=t.result.item.title);r.createPlayer({type:"kodi",index:99,bgImage:r.kodi.getImage(t.result.item.thumbnail),title:i,subtitle:u})}}});i.kodi.loading=!1;r.nowPlayingCallback()},getPlayerId:function(){n.ajax({url:i.kodi.urlJSON,type:"POST",async:!1,contentType:"application/json",data:JSON.stringify({id:"activaplayers",jsonrpc:"2.0",method:"Player.GetActivePlayers"}),timeout:i.kodi.timeout,beforeSend:function(n){n.setRequestHeader("Authorization","Basic "+btoa(i.kodi.username+":"+i.kodi.password))},success:function(n){if(n.result[0])return n.result[0].playerid}})},getImage:function(t){n.ajax({url:i.kodi.urlJSON,type:"POST",async:!1,contentType:"application/json",data:JSON.stringify({id:"preparedl",jsonrpc:"2.0",method:"Files.PrepareDownload",params:{path:t}}),timeout:i.kodi.timeout,beforeSend:function(n){n.setRequestHeader("Authorization","Basic "+btoa(i.kodi.username+":"+i.kodi.password))},success:function(n){return i.kodi.url+"/"+n.result.details.path}})}}};return r.initialize(),r})}}(jQuery),function(n){n.fn.opcache=function(t){var i=n.extend({block:this,charts:[{name:"Memory",legendNames:["Used","Free","Wasted"],unitIndicator:"MB",active:!0},{name:"Keys",legendNames:["Cached","Free"],unitIndicator:!1,active:!1},{name:"Hits",legendNames:["Misses","Hits"],unitIndicator:!1,active:!1},{name:"Restarts",legendNames:["Memory","Manual","Keys"],unitIndicator:!1,active:!1},]},t),r={initialize:function(){if(i.block.length!==0){n.getJSON("opcache/dataset",function(n){i.charts[0].data=n.memory;i.charts[1].data=n.keys;i.charts[2].data=n.hits;i.charts[3].data=n.restarts;r.initializeChart(i.charts[0])});i.block.find(".fa-chevron-right, .fa-chevron-left").off().on("click",function(){var u=1,e=i.charts.find(function(n){return n.active===!0}),f=i.charts.indexOf(e),t;n(this).hasClass("fa-chevron-left")&&(u=-1);t=f+u;t>=i.charts.length?t=0:t<0&&(t=i.charts.length-1);i.charts[f].active=!1;i.charts[t].active=!0;i.block.find(".panel-body h4").text(i.charts[t].name);r.initializeChart(i.charts[t])})}},initializeChart:function(n){typeof n=="undefined"&&(n=i.charts[0]);var t=new Chartist.Pie(".panel.opcache .graph",{series:n.data},{donut:!0,donutWidth:30,showLabel:!0,plugins:[Chartist.plugins.legend({position:"bottom",legendNames:n.legendNames})],labelInterpolationFnc:function(t){return t+(n.unitIndicator?" "+n.unitIndicator:"")}});t.on("draw",r.animateChart);t.on("created",function(){setTimeout(function(){i.block.find(".ct-label ").fadeTo("fast",1)},1e3)})},animateChart:function(n){var t,i;n.type==="slice"&&(t=n.element._node.getTotalLength(),n.element.attr({"stroke-dasharray":t+"px "+t+"px"}),i={"stroke-dashoffset":{id:"anim"+n.index,dur:750,from:-t+"px",to:"0px",easing:Chartist.Svg.Easing.easeOutQuint,fill:"freeze"}},n.index!==0&&(i["stroke-dashoffset"].begin="anim"+(n.index-1)+".end"),n.element.attr({"stroke-dashoffset":-t+"px"}),n.element.animate(i,!1))}};return r.initialize(),r}}(jQuery),function(n){n.fn.phpsysinfo=function(t){this.each(function(){var r=n.extend({block:n(this)},t),i={initialize:function(){if(r.block.length!==0){r.block.find(".fa-sync").off().on("click",function(){r.block.hasClass("processes")?i.getPsStatus():i.getAll()});r.block.hasClass("sysinfo")&&i.getAll()}},getAll:function(){n(".sysinfo, #hardware, .harddisks, .processes").isLoading();n.ajax({url:"phpsysinfo/",dataType:"json",success:function(t){var u=n("#hardware"),r=n(".sysinfo"),f=n(".harddisks");i.setSysinfo(t,r);i.setCPUCores(t,u);i.setNetwork(t,u);i.setRAM(t,r);i.setDisks(t,f);i.setUpdateNotifier(t,r);i.setPsStatus(t)},complete:function(){n(".sysinfo, #hardware, .harddisks, .processes").isLoading("hide")}})},setSysinfo:function(n,t){t.find("div.host").html(n.Vitals["@attributes"].Hostname);t.find("div.distro span").html(n.Vitals["@attributes"].Distro);t.find("div.distro div.icon").css("background-image","url('"+r.url+"gfx/images/"+n.Vitals["@attributes"].Distroicon+"')");t.find("div.kernel").html(n.Vitals["@attributes"].Kernel);var i=new Date;i.setSeconds(i.getSeconds()-Math.floor(n.Vitals["@attributes"].Uptime));r.block.find("div.time").data("tinyTimer")!==undefined&&clearInterval(r.block.find("div.time").data("tinyTimer").interval);t.find("div.time").tinyTimer({from:i,format:"%d days %0h:%0m:%0s"})},setCPUCores:function(t,i){i.find(".cpu-model .value").html(t.Hardware.CPU.CpuCore[0]["@attributes"].Model);i.find(".motherboard .value").html(t.Hardware["@attributes"].Name);n.each(t.Hardware.CPU.CpuCore,function(r,u){var s=Math.round(u["@attributes"].CpuSpeed/10)/100+" GHz",h=Math.round(u["@attributes"].CpuSpeedMin/10)/100+" GHz",c=Math.round(u["@attributes"].CpuSpeedMax/10)/100+" GHz",e,o,f;n.each(t.MBInfo.Temperature.Item,function(i,u){n.trim(u["@attributes"].Label.toLowerCase()).indexOf("core "+r)!==-1&&(e="Core "+r,o=u["@attributes"].Value+" &deg;"+t.Options["@attributes"].tempFormat.toUpperCase())});f=i.find("li.cpu-cores:not(.clone)").eq(r);f.length===0&&(f=i.find("li.cpu-cores.clone").clone(),f.removeClass("hidden clone"),f.insertAfter(i.find(".motherboard")));f.find(".cpu-core").html(e);f.find(".core-temp").html(o);f.find(".core-current").html(s);f.find(".core-min").html(h);f.find(".core-max").html(c)})},setNetwork:function(t,i){n.isArray(t.Network.NetDevice)||(t.Network.NetDevice=new Array(t.Network.NetDevice));n.each(t.Network.NetDevice,function(n,t){if(typeof t["@attributes"]!="undefined"){var f=Math.round(t["@attributes"].RxBytes/1073741824*100)/100+" GB",e=Math.round(t["@attributes"].TxBytes/1073741824*100)/100+" GB",u=t["@attributes"].Info.split(";"),r=i.find(".lan-stats > div:not(.clone)").eq(n);r.length===0&&(r=i.find(".lan-stats > .clone").clone(),r.removeClass("hidden clone"),r.appendTo(i.find(".lan-stats")));r.find(".lan-name").html(t["@attributes"].Name);r.find(".lan-mac").html(u[0]);r.find(".lan-ip").html(u[1]);r.find(".lan-speed").html(u[u.length-1]);r.find(".lan-rx").html(f);r.find(".lan-tx").html(e)}})},setRAM:function(n,t){t.find("div.ram").find(".progress-bar").css("width",n.Memory["@attributes"].Percent+"%");t.find("div.ram").find(".percent span").html(n.Memory["@attributes"].Percent);n.Memory.Swap!==undefined?(t.find("div.swap").find(".progress-bar").css("width",n.Memory.Swap["@attributes"].Percent+"%"),t.find("div.swap").find(".percent span").html(n.Memory.Swap["@attributes"].Percent)):t.find("div.swap").closest("li").hide()},setDisks:function(t,i){t.FileSystem.Mount.sort(function(n,t){return n["@attributes"].MountPoint<t["@attributes"].MountPoint?-1:1});n.each(t.FileSystem.Mount,function(n,t){var r=i.find("li:not(.clone)").eq(n),u;r.length===0&&(r=i.find("li.clone").clone(),r.removeClass("hidden clone"),r.appendTo(i.find("ul")));u=t["@attributes"].Percent+"%";r.find(".name").html(t["@attributes"].MountPoint);r.find(".progress-bar").css("width",u);r.find(".percent").html(u);t["@attributes"].Percent>90?r.find(".progress-bar").addClass("progress-bar-danger"):t["@attributes"].Percent>70?r.find(".progress-bar").addClass("progress-bar-warning"):t["@attributes"].Percent>50?r.find(".progress-bar").addClass("progress-bar-info"):r.find(".progress-bar").addClass("progress-bar-success")})},setUpdateNotifier:function(n,t){n.Plugins.Plugin_UpdateNotifier!==undefined&&(t.find(".update .packages .value").html(n.Plugins.Plugin_UpdateNotifier.UpdateNotifier.packages),t.find(".update .security .value").html(n.Plugins.Plugin_UpdateNotifier.UpdateNotifier.security))},getPsStatus:function(){n(".processes").isLoading();n.ajax({url:"phpsysinfo/index/psstatus",dataType:"json",success:function(n){i.setPsStatus(n)},complete:function(){n(".processes").isLoading("hide")}})},setPsStatus:function(t){t.Plugins.Plugin_PSStatus.Process.sort(function(n,t){return n["@attributes"].Name<t["@attributes"].Name?-1:1});n.each(t.Plugins.Plugin_PSStatus.Process,function(t,i){var u=n("<li />",{"class":"list-group-item col-xs-12 col-md-12"}),f=n("<div />",{"class":"col-xs-10"}),e=n("<div />",{"class":"col-xs-2 text-right"}),r=n("<span />",{"class":"label"});f.html(i["@attributes"].Name);f.appendTo(u);i["@attributes"].Status==="1"?(r.html("On"),r.addClass("label-success")):(r.html("Off"),r.addClass("label-danger"));r.appendTo(e);e.appendTo(u);n("div.processes li div:contains('"+i["@attributes"].Name+"')").parent().remove();u.appendTo(n("div.processes ul"))})}};return i.initialize(),i})}}(jQuery),function(n){n.fn.pihole=function(t){var i=n.extend({block:this,url:n(this).data("pihole-url"),charts:[{name:"Queries today",legendNames:["Cached","Not cached","Blocked"],active:!0},]},t),r={initialize:function(){if(i.block.length!==0){i.block.on("click",".fa-sync",function(){r.refresh()});r.refresh()}},refresh:function(){n.getJSON(i.url+"api.php?summaryRaw",function(n){i.charts[0].data=[n.queries_cached,n.dns_queries_today-n.queries_cached,n.ads_blocked_today];r.initializeChart(i.charts[0])})},initializeChart:function(n){typeof n=="undefined"&&(n=i.charts[0]);var t=new Chartist.Pie(".panel.pihole .graph",{series:n.data},{donut:!0,donutWidth:30,showLabel:!0,plugins:[Chartist.plugins.legend({position:"bottom",legendNames:n.legendNames})],labelInterpolationFnc:function(t){return t+(n.unitIndicator?" "+n.unitIndicator:"")}});t.on("draw",r.animateChart);t.on("created",function(){setTimeout(function(){i.block.find(".ct-label ").fadeTo("fast",1)},1e3)})},animateChart:function(n){var t,i;n.type==="slice"&&(t=n.element._node.getTotalLength(),n.element.attr({"stroke-dasharray":t+"px "+t+"px"}),i={"stroke-dashoffset":{id:"anim"+n.index,dur:750,from:-t+"px",to:"0px",easing:Chartist.Svg.Easing.easeOutQuint,fill:"freeze"}},n.index!==0&&(i["stroke-dashoffset"].begin="anim"+(n.index-1)+".end"),n.element.attr({"stroke-dashoffset":-t+"px"}),n.element.animate(i,!1))}};return r.initialize(),r}}(jQuery),function(n){n.fn.sickrage=function(t){var i=n.extend({block:this,apiKey:this.data("sickrage-apikey"),baseUrl:this.data("sickrage-url")},t),r={initialize:function(){if(i.block.length!==0){i.block.find(".fa-sync").on("click",function(){r.refresh()});r.refresh(!0)}},refresh:function(t){t||i.block.isLoading();var u=i.block.find("#today .list-group"),f=i.block.find("#soon .list-group");n.ajax({url:r.url("future","today|soon"),dataType:"json",success:function(t){t=t.data;u.find("a:not(.hidden)").remove();f.find("a:not(.hidden)").remove();n.each(t.today,function(n,t){r.createItems(u,t)});n.each(t.soon,function(n,t){r.createItems(f,t)})},complete:function(){t||i.block.isLoading("hide");u.find(".list-group-item:not(.hidden)").length?i.block.find("a:eq(0)").attr("data-toggle","tab"):(i.block.find("a[href='#soon']").tab("show"),i.block.find("a[href='#today']").parent().addClass("disabled"),i.block.find("a[href='#today']").attr("data-toggle",""))}})},createItems:function(t,r){var f=t.find("a.hidden").clone(),s=f.find(".episode"),u=i.block.find(".sickrage-detail").clone(),e="S"+zeropad(r.season,2)+"E"+zeropad(r.episode,2),o="t"+r.tvdbid+"-"+e;s.html(e+" | "+r.show_name);u.attr("data-fancybox",t.attr("id"));u.attr("id",o);u.find("h4").html(r.show_name);u.find(".plot").html(r.ep_plot);u.find(".season").html(zeropad(r.season,2));u.find(".episode").html(zeropad(r.episode,2));u.find(".episodename").html(r.ep_name);u.find(".airdate").html(r.airdate);f.on("click",function(){return n.fancybox.open({src:"#"+o,margin:[0]}),!1});u.appendTo(f);f.removeClass("hidden");f.prependTo(t)},url:function(n,t){return i.baseUrl+"api/"+i.apiKey+"/?cmd="+n+"&type="+t}};r.initialize()}}(jQuery),function(n){n.fn.speedtest=function(t){var i=n.extend({block:this,testOrder:this.data("speedtest-testorder"),uploadTime:this.data("speedtest-uploadtime"),downloadTime:this.data("speedtest-downloadtime"),getISPIP:this.data("speedtest-getispip"),distanceUnit:this.data("speedtest-distance"),telemetry:this.data("speedtest-telemetry"),animationFrameId:-1,colors:{meterBk:"#E0E0E0",dlColor:"#6060AA",ulColor:"#309030",pingColor:"#AA6060",jitColor:"#AA6060",progColor:"#EEEEEE"}},t),f=null,u=null,r={initialize:function(){if(i.block.length!==0){i.block.find(".fa-play, .fa-stop").on("click",function(){n(this).toggleClass("fa-play fa-stop");r.startStop()});i.block.find("h4").click(function(){i.block.find(".panel-body").is(":visible")&&r.initUI()});window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(n){setTimeout(n,1e3/60)};setTimeout(r.initUI,100)}},initializeIframe:function(){var t=i.block.closest(".panel.with-nav-tabs"),r=new Chartist.Bar("#ct-chart",{labels:i.block.data("labels").toString().indexOf(",")!=-1?i.block.data("labels").split(","):[i.block.data("labels")],series:[i.block.data("dl").toString().indexOf(",")!=-1?i.block.data("dl").split(","):[i.block.data("dl")],i.block.data("ul").toString().indexOf(",")!=-1?i.block.data("ul").split(","):[i.block.data("ul")],i.block.data("ping").toString().indexOf(",")!=-1?i.block.data("ping").split(","):[i.block.data("ping")],i.block.data("jitter").toString().indexOf(",")!=-1?i.block.data("jitter").split(","):[i.block.data("jitter")]]},{horizontalBars:!0,height:"650px",plugins:[Chartist.plugins.legend({legendNames:["Download","Upload","Ping","Jitter"]})]});t.find(".nav-tabs a").click(function(){setTimeout(function(){r.update()},250)});t.find(".paginator a:not([href='#'])").click(function(){var i=n(this).attr("href"),r=i.indexOf("stats/"),u=t.find(".nav-tabs li.active a").attr("href").replace("#","")+"/",f=i.substr(i.lastIndexOf("/")+1),e=i.substr(0,r+6)+u+f;n(this).attr("href",e)})},drawMeter:function(n,t,i,r,u,f){var e=n.getContext("2d"),c=window.devicePixelRatio||1,h=n.clientWidth*c,s=n.clientHeight*c,o=s*.0055;n.width==h&&n.height==s?e.clearRect(0,0,h,s):(n.width=h,n.height=s);e.beginPath();e.strokeStyle=i;e.lineWidth=16*o;e.arc(n.width/2,n.height-58*o,Math.abs(n.height/1.8-e.lineWidth),-Math.PI*1.1,Math.PI*.1);e.stroke();e.beginPath();e.strokeStyle=r;e.lineWidth=16*o;e.arc(n.width/2,n.height-58*o,Math.abs(n.height/1.8-e.lineWidth),-Math.PI*1.1,t*Math.PI*1.2-Math.PI*1.1);e.stroke();typeof u!="undefined"&&(e.fillStyle=f,e.fillRect(n.width*.3,n.height-16*o,n.width*.4*u,4*o))},startStop:function(){f!=null?(f.postMessage("abort"),f=null,u=null,cancelAnimationFrame(i.animationFrameId),r.initUI()):(r.frame(),f=new Worker("vendor/speedtest/speedtest_worker.min.js?t="+Date.now()),f.postMessage("start "+JSON.stringify({url_dl:"../../speedtest/garbage",url_ul:"../../speedtest/empty",url_ping:"../../speedtest/empty",url_getIp:"../../speedtest/getIP",url_telemetry:"../../speedtest/telemetry",telemetry_level:i.telemetry,time_ul_max:i.uploadTime,time_dl_max:i.downloadTime,time_auto:!1,getIp_ispInfo:i.getISPIP,getIp_ispInfo_distance:i.distanceUnit})),f.onmessage=function(n){u=JSON.parse(n.data);u.testState>=4&&(f=null,r.updateUI(!0),cancelAnimationFrame(i.animationFrameId),i.block.find(".fa-play, .fa-stop").removeClass("fa-stop").addClass("fa-play"))})},mbpsToAmount:function(n){return 1-1/Math.pow(1.3,Math.sqrt(n))},msToAmount:function(n){return 1-1/Math.pow(1.08,Math.sqrt(n))},oscillate:function(){return 1+.02*Math.sin(Date.now()/100)},initUI:function(){r.drawMeter(n("#dlMeter")[0],0,i.colors.meterBk,i.colors.dlColor,0);r.drawMeter(n("#ulMeter")[0],0,i.colors.meterBk,i.colors.ulColor,0);r.drawMeter(n("#pingMeter")[0],0,i.colors.meterBk,i.colors.pingColor,0);r.drawMeter(n("#jitMeter")[0],0,i.colors.meterBk,i.colors.jitColor,0);n("#dlText").textContent="";n("#ulText").textContent="";n("#pingText").textContent="";n("#jitText").textContent="";n("#ip").textContent=""},frame:function(){i.animationFrameId=requestAnimationFrame(r.frame);r.updateUI()},updateUI:function(t){if(f&&f.postMessage("status"),u||t){var e=u.testState;n("#ip").text(u.clientIp);n("#dlText").text(e==1&&u.dlStatus==0?"...":u.dlStatus);r.drawMeter(n("#dlMeter")[0],r.mbpsToAmount(Number(u.dlStatus*(e==1?r.oscillate():1))),i.colors.meterBk,i.colors.dlColor,Number(u.dlProgress),i.colors.progColor);n("#ulText").text(e==3&&u.ulStatus==0?"...":u.ulStatus);r.drawMeter(n("#ulMeter")[0],r.mbpsToAmount(Number(u.ulStatus*(e==3?r.oscillate():1))),i.colors.meterBk,i.colors.ulColor,Number(u.ulProgress),i.colors.progColor);n("#pingText").text(u.pingStatus);r.drawMeter(n("#pingMeter")[0],r.msToAmount(Number(u.pingStatus*(e==2?r.oscillate():1))),i.colors.meterBk,i.colors.pingColor,Number(u.pingProgress),i.colors.progColor);n("#jitText").text(u.jitterStatus);r.drawMeter(n("#jitMeter")[0],r.msToAmount(Number(u.jitterStatus*(e==2?r.oscillate():1))),i.colors.meterBk,i.colors.jitColor,Number(u.pingProgress),i.colors.progColor)}}};return n("body#iframe").length||r.initialize(),r};n("#ct-chart").length&&n("#ct-chart").speedtest().initializeIframe()}(jQuery),function(n){n.fn.transmission=function(t){var i=n.extend({defaultData:{type:"POST",beforeSend:function(n){n.setRequestHeader("Authorization","Basic "+btoa(i.block.data("transmission-username")+":"+i.block.data("transmission-password")));n.setRequestHeader("X-Transmission-Session-Id",i.transmissionSessionId)},statusCode:{409:function(n){i.transmissionSessionId=n.getResponseHeader("X-Transmission-Session-Id")}},url:this.data("transmission-url")+"rpc/"},block:this,transmissionSessionId:-1,updateInterval:this.data("transmission-update-interval")*1e3,updateIntervalId:-1},t),r={getTorrents:function(t){t=typeof t=="undefined"?!1:t;t||i.block.isLoading();clearInterval(i.updateIntervalId);i.updateIntervalId=setInterval(function(){r.getTorrents(!1)},i.updateInterval);i.block.find(".fa-sync").off().on("click",function(){r.getTorrents(!1);n(this).blur()});var u=i.defaultData;return u.data='{"method":"torrent-get", "arguments":{"fields":["id", "name", "percentDone", "status"]}}',u.complete=function(u){var e,f;if(u.status===200)e=n.parseJSON(u.responseText),i.block.find("li").not(".hidden").remove(),e.arguments.torrents.length===0&&(f=i.block.find("li.hidden").clone(),f.removeClass("hidden"),f.find(".torrentname").html("No torrents found"),f.find(".torrentname").removeClass("col-xs-4"),f.find(".torrentprogress, .torrentactions").remove(),f.appendTo(n(".transmission ul"))),n.each(e.arguments.torrents,function(t,u){var f=i.block.find("li.hidden").clone();f.attr("data-id",u.id);f.removeClass("hidden");f.find(".torrentname").html(u.name);f.find(".torrentname").attr("title",u.name);u.percentDone=Math.round(u.percentDone*1e4)/100;f.find(".torrentprogress .percent").html(u.percentDone+"%");f.find(".torrentprogress .progress-bar").width(u.percentDone+"%");u.status===4?(f.find(".torrentactions .status").removeClass("fa-play"),f.find(".torrentactions .status").addClass("fa-pause")):u.status===0&&(f.find(".torrentactions .status").removeClass("fa-pause"),f.find(".progress-bar").removeClass("progress-bar-success").addClass("progress-bar-primary"),f.find(".torrentactions .status").addClass("fa-play"));f.find(".torrentactions .status").off().on("click",function(){self.startStopTorrents(n(this).closest("li").data("id"),self)});f.find(".torrentactions .fa-trash-alt").off().on("click",function(){openConfirmDialog("Delete torrent?",[],function(){n.fancybox.close();n(this).attr("id")==="confirm-yes"&&r.removeTorrents(f.data("id"))})});f.appendTo(n(".transmission ul"))});else if(u.status===409){t||i.block.isLoading("hide");r.getTorrents(t);return}t||i.block.isLoading("hide")},n.ajax(u),self},startStopTorrents:function(t){var u=i.defaultData;u.data='{"method":"torrent-'+(n("li[data-id="+t+"] button.status:first-child").hasClass("fa-pause")?"stop":"start-now")+'", "arguments":{"ids":['+t+"]}}";u.complete=function(i){if(i.status===409)r.startTorrents(t);else if(i.status===200){var u=n.parseJSON(i.responseText);u.result==="success"&&(n("li[data-id="+t+"] button.status").toggleClass("fa-pause fa-play"),n("li[data-id="+t+"] .progress-bar").toggleClass("progress-bar-success progress-bar-primary"))}};n.ajax(u)},removeTorrents:function(t){var u=i.defaultData;u.data='{"method":"torrent-remove", "arguments":{"ids":['+t+']}, "delete-local-data": true}';u.complete=function(i){if(i.status===409)r.removeTorrents(t);else if(i.status===200){var u=n.parseJSON(i.responseText);u.result==="success"&&(n("li[data-id="+t+"]").remove(),r.getTorrents(!1))}};n.ajax(u)}};return i.block.length!==0&&r.getTorrents(!0),r}}(jQuery),function(n){n.fn.youless=function(t){var i=n.extend({block:this,updateInterval:this.data("updateinterval")*1e3,updateIntervalId:-1},t),r={initialize:function(){if(i.block.length!==0){i.block.on("click",".fa-sync",function(){clearInterval(i.updateIntervalId);i.updateIntervalId=setInterval(function(){r.refresh()},i.updateInterval);r.refresh()});i.updateIntervalId=setInterval(function(){r.refresh()},i.updateInterval)}},refresh:function(){i.block.isLoading();n.ajax({url:"youless/",dataType:"json",success:function(n){i.block.find(".counter .value").text(n.counter);i.block.find(".power .value span").text(n.power);i.block.find(".power .value").attr("class","value "+n.class)},complete:function(){i.block.isLoading("hide")}})}};return r.initialize(),r}}(jQuery),function(n){n.fn.snmp=function(t){var i=n.extend({block:n(this),updateInterval:n(this).data("update-interval")*1e3,updateIntervalId:-1},t),r={initialize:function(){i.block.find(".fa-chevron-left, .fa-chevron-right").click(function(){var u=n(this).hasClass("fa-chevron-right")?1:-1,f=i.block.find(".host:visible"),t=f.index(),r=i.block.find(".host:eq("+(t+u)+")"),e=r.length===1?t+u:0;r=i.block.find(".host:eq("+e+")");t!==e&&f.fadeOut("fast",function(){r.fadeIn("fast").css("display","block")})});i.block.find("a").click(function(){n(this).attr("href","/portal/snmp/details/"+i.block.find(".host:visible").data("id"))});i.block.find(".fa-sync").click(r.update);i.updateIntervalId=window.setInterval(r.update,i.updateInterval);i.block.find(".host").each(function(t,i){n.get("snmp/hostcontent/"+n(i).data("id"),function(t){n(i).html(t);initializeTinyTimer(n(i).find(".time"))})})},update:function(t){i.block.isLoading();t===undefined&&(t=i.block.find(".host:visible"));window.clearInterval(i.updateIntervalId);var u=t.find("div.time");u.data("tinyTimer")!==undefined&&clearInterval(u.data("tinyTimer").interval);n.get("snmp/hostcontent/"+t.data("id"),function(n){t.html(n);initializeTinyTimer(t.find(".time"))});i.updateIntervalId=window.setInterval(r.update,i.updateInterval);i.block.isLoading("hide")}};return r.initialize(),r}}(jQuery),function(n){n.fn.verisure=function(t){var i=n.extend({block:n(this),updateInterval:n(this).data("update-interval")*1e3,updateIntervalId:-1},t),r={initialize:function(){if(i.block.length!==0){n.fancybox.defaults.btnTpl.take_photo="<button data-fancybox-take-photo class='fancybox-button fa fa-camera' title='Take photo'><\/button>";n("body").on("click","[data-fancybox-take-photo]",function(){r.take_photo(encodeURI(n.fancybox.getInstance().current.deviceLabel))});n("body").on("click","#verisure_device_select button",function(){r.take_photo(encodeURI(n(this).data("deviceLabel")))});n("body").on("click","#verisure_set_armstate button",function(){r.set_arm_state(n(this).data("state"))});i.block.find(".fa-sync").click(r.update);i.block.find(".fa-camera").click(r.photos);i.block.find(".fa-image").click(r.select_device);i.block.find(".top button").click(function(){n.fancybox.open({src:"#verisure_set_armstate"})});i.updateIntervalId=window.setInterval(r.update,i.updateInterval)}},update:function(){i.block.isLoading();window.clearInterval(i.updateIntervalId);n.ajax({url:"verisure",dataType:"json",success:function(t){var r=new Date(t.armState.date),f=new RegExp("_","g"),e=t.armState.statusType.toLowerCase().capitalize().replace(f," "),o=t.armState.changedVia.toLowerCase().capitalize().replace(f," "),u;i.block.find(".status").html(e);i.block.find(".name").html(t.armState.name!==undefined?t.armState.name:"Unknown");i.block.find(".date").html(r.getDate()+"-"+zeropad(r.getMonth()+1,2)+"-"+r.getFullYear()+" "+zeropad(r.getHours(),2)+":"+zeropad(r.getMinutes(),2));i.block.find(".via").html(o);u=i.block.find("#amstate button");switch(t.armState.statusType){default:u.attr("class","fa fa-verisure-stay text-warning");i.block.find(".fa-image").addClass("hidden");break;case"DISARMED":u.attr("class","fa fa-verisure-disarmed text-danger");i.block.find(".fa-image").addClass("hidden");break;case"ARMED_AWAY":u.attr("class","fa fa-verisure-away text-success");i.block.find(".fa-image").removeClass("hidden")}n.each(t.climateValues,function(n,t){var r=i.block.find("#"+t.deviceLabel.replace(/\s/g,"_"));r.find(".value").html(t.temperature+"&deg;");r.find("i").attr("class","fa fa-thermometer-half "+t.cssClass)})},complete:function(n){var t=i.updateInterval;n.status==429&&(t*=2,console.log(n.errorMessage));i.updateIntervalId=window.setInterval(r.update,t);i.block.isLoading("hide")}})},set_arm_state:function(t){var i=n("#verisure_set_armstate #verisure_pin").val();n.ajax({url:"verisure/arm/"+t+"/"+(i!==undefined?i:""),success:function(){showAlert("success","Alarm state changed");n.fancybox.getInstance().close();r.update();switch(t){default:n("#verisure_set_armstate #arm_stay").addClass("hidden");n("#verisure_set_armstate #arm_away").removeClass("hidden");n("#verisure_set_armstate #disarm").removeClass("hidden");n("#verisure_set_armstate #current_stay").removeClass("hidden");n("#verisure_set_armstate #current_away").addClass("hidden");n("#verisure_set_armstate #current_disarmed").addClass("hidden");break;case"DISARMED":n("#verisure_set_armstate #arm_stay").removeClass("hidden");n("#verisure_set_armstate #arm_away").removeClass("hidden");n("#verisure_set_armstate #disarm").addClass("hidden");n("#verisure_set_armstate #current_stay").addClass("hidden");n("#verisure_set_armstate #current_away").addClass("hidden");n("#verisure_set_armstate #current_disarmed").removeClass("hidden");break;case"ARMED_AWAY":n("#verisure_set_armstate #arm_stay").removeClass("hidden");n("#verisure_set_armstate #arm_away").addClass("hidden");n("#verisure_set_armstate #disarm").removeClass("hidden");n("#verisure_set_armstate #current_stay").addClass("hidden");n("#verisure_set_armstate #current_away").removeClass("hidden");n("#verisure_set_armstate #current_disarmed").addClass("hidden")}},error:function(){showAlert("danger","Something went wrong")}})},photos:function(){var t=[],r=n.parseJSON(i.block.find(".fa-camera").attr("data-photos")).imageSeries;n.each(r,function(n,i){var r=new Date(i.image[0].captureTime),u=r.getDate()+"-"+zeropad(r.getMonth()+1,2)+"-"+r.getFullYear()+" "+zeropad(r.getHours(),2)+":"+zeropad(r.getMinutes(),2);t.push({src:"/portal/verisure/image/"+encodeURI(i.deviceLabel)+"/"+encodeURI(i.image[0].imageId)+"/"+encodeURI(i.image[0].captureTime),caption:i.area+" ("+u+")",deviceLabel:i.deviceLabel})});t.sort(function(n,t){return n.caption>t.caption?-1:1});n.fancybox.open(t,{buttons:[i.block.find("#amstate button").hasClass("fa-verisure-away")?"take_photo":null,"close"],loop:!0})},take_photo:function(t){n.ajax({url:"verisure/captureimage/"+t,dataType:"json",success:function(){n.fancybox.getInstance().close();window.setTimeout(function(){n.ajax({url:"verisure/imageseries/",dataType:"json",success:function(n){i.block.find(".fa-camera").attr("data-photos",JSON.stringify(n)).removeClass("hidden");showAlert("success","photo taken")}})},3e4)},error:function(){showAlert("danger","Something went wrong")}})},select_device:function(){n.fancybox.open({src:"#verisure_device_select"})}};return r.initialize(),r}}(jQuery);"use strict";var speedtest=!1,opcache=!1,pihole=!1,snmp=!1;$(function(){initializeDashboardEventHandlers();initializePlugins();$("html").hasClass("time")&&getLocation()});