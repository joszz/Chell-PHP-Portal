/*! chell-php-portal v1.4.0 | (c) 2021 Jos Nienhuis | GPL-2.0 License */
"use strict";!function(o){o.fn.couchpotato=function(t){var a=o.extend({block:this,apiKey:this.data("couchpotato-apikey"),baseUrl:this.data("base-url"),couchpotatoBaseUrl:this.data("couchpotato-url")},t),e={initialize:function(){0!==a.block.length&&(a.block.find(".fa-sync").on("click",e.refresh),a.block.find(".fa-search").on("click",e.searchWantedMovies))},refresh:function(){a.block.isLoading(),a.block.find(".item").remove(),o.ajax({url:e.url("media.list"),dataType:"json",success:function(t){o.each(t.movies,function(t,e){var o=a.block.find("a.clone").clone();o.removeClass("clone").addClass("item"),o.attr({href:a.baseUrl+"couchpotato/movie/"+e._id,"data-fancybox":"couchpotato","data-type":"iframe",title:e.info.tagline}),0===t&&o.removeClass("hidden_not_important"),o.find(".title").html(e.title),o.find(".subtitle").html(e.info.tagline),o.css("background-image","url('"+e.info.images.poster+"')"),o.attr("title",e.title),o.appendTo(a.block.find(".panel-body"))})},complete:function(){a.block.isLoading("hide")}})},searchWantedMovies:function(){showAlert("success","Initiating Couchpotato movie search"),o.ajax({url:e.url("movie.searcher.full_search"),dataType:"json"})},url:function(t){return a.couchpotatoBaseUrl+"api/"+a.apiKey+"/"+t+"/"}};e.initialize()}}(jQuery);;!function(n){n.fn.database_stats=function(e){var i=n.extend({block:n(this),updateInterval:1e3*n(this).data("update-interval"),updateIntervalId:-1},e),t={initialize:function(){i.block.find(".fa-sync").click(function(){t.update(!1)}),t.update(!0)},update:function(e){(e=void 0!==e&&e)||(i.block.isLoading(),window.clearInterval(i.updateIntervalId)),n.ajax({url:"databaseStats",dataType:"json",success:function(e){i.block.find(".uptime").text(e.uptime),i.block.find(".threads").text(e.threads),i.block.find(".questions").text(e.questions),i.block.find(".slow-queries").text(e.slow_queries),i.block.find(".opens").text(e.opens),i.block.find(".flush-tables").text(e.flush_tables),i.block.find(".open-tables").text(e.open_tables),i.block.find(".queries-per-second").text(e.queries_per_second_avg);var t=new Date;t.setSeconds(t.getSeconds()-Math.floor(e.uptime)),void 0!==i.block.find("div.time").data("tinyTimer")&&clearInterval(i.block.find("div.time").data("tinyTimer").interval),i.block.find("div.time").tinyTimer({from:t,format:"%d days %0h:%0m:%0s"})},complete:function(){i.updateIntervalId=window.setInterval(t.update,i.updateInterval),i.block.isLoading("hide")}})}};return t.initialize(),t}}(jQuery);;!function(o){o.fn.devices=function(t){var a=o.extend({block:this,updateInterval:1e3*this.data("device-state-interval"),updateIntervalId:-1},t),e={initialize:function(){0!==a.block.length&&(a.block.on("click",".fa-sync",function(){clearInterval(a.updateIntervalId),a.updateIntervalId=setInterval(function(){self.checkstates(self)},a.updateInterval),e.checkstates(a.block)}),a.block.on("click",".btn-danger",function(){var t="Wake <span>"+o(this).closest("li").find("div:first").html().trim()+"</span>?";openConfirmDialog(t,[{mac:o(this).data("mac")}],function(){e.wol(o(this))})}),a.block.on("click",".btn-success",function(){var t="Shutdown <span>"+o(this).closest("li").find("div:first").html().trim()+"</span>?";openConfirmDialog(t,[{id:o(this).data("id")}],function(){e.doShutdown(o(this))})}),e.checkstates())},checkstates:function(t){t=void 0===t?this:t;var c=new Date;clearInterval(a.updateIntervalId),a.updateIntervalId=setInterval(function(){t.checkstates(t)},a.updateInterval),a.block.find(".devicestate").each(function(){var a,e,s,t=o(this),n=o(this).find("span.fa"),i=o(this).data("id"),d=o("ul.nav li[data-id='"+i+"'");d.find("a").bind("click",!1),o(this).removeClass("btn-danger btn-success"),o(this).addClass("disabled"),n.removeClass("fa-power-off"),n.addClass("fa-sync fa-spin"),a=t,e=d,s=n,o.getJSON("devices/state/"+i+"/"+c.getTime(),"",function(t){s.removeClass("fa-sync fa-spin"),s.addClass("fa-power-off"),a.removeClass("disabled"),"none"===a.data("shutdown-method")&&a.addClass("disabled"),t.state?(e.removeClass("disabled"),a.parent().find(".hypervadmin").removeClass("disabled"),e.find("a").unbind("click",!1)):(e.addClass("disabled"),a.parent().find(".hypervadmin").addClass("disabled")),a.addClass("btn-"+(t.state?"success":"danger"))})})},wol:function(t){var a;o.fancybox.close(),"confirm-yes"===t.attr("id")&&(a=t.closest("div").find("h2 span").html().trim(),o.get("devices/wol/"+t.closest("div").data("id"),void showAlert("success","Magic packet send to: "+a)))},doShutdown:function(t){var a,s;o.fancybox.close(),"confirm-yes"===t.attr("id")&&(t=(a=t.closest("div")).data("id"),s=a.closest("div").find("h2 span").html().trim(),o.get("devices/shutdown/"+t,function(t){var a="danger",e="Shutdown command failed for: "+s;"true"===t&&(a="success",e="Shutdown command send to: "+s),showAlert(a,e)}))}};return e.initialize(),e}}(jQuery);;!function(n){n.fn.gallery=function(e){this.each(function(){var a=n.extend({block:n(this),rotateInterval:1e3*n(this).data("rotate-interval"),rotateIntervalId:-1},e),t={initialize:function(){0!==a.block.length&&(a.rotateIntervalId=setInterval(function(){t.rotateGallery("right")},a.rotateInterval),a.block.find(".fa-chevron-left, .fa-chevron-right").click(function(){clearInterval(a.rotateIntervalId),t.rotateGallery(n(this).hasClass("fa-chevron-left")?"left":"right"),a.rotateIntervalId=setInterval(function(){t.rotateGallery("right")},a.rotateInterval)}))},rotateGallery:function(t){var e,n;!a.block.find(".panel-body:visible").length||(e=a.block.find(".item:visible").index())!==(n=1===a.block.find(".item:eq("+(e+(t="right"===t?1:-1))+")").length?e+t:0)&&a.block.find(".item:eq("+e+")").fadeOut("fast",function(){a.block.find(".item:eq("+n+")").fadeIn("fast").css("display","block")})}};t.initialize()})}}(jQuery);;!function(d){d.fn.hypervadmin=function(e){var n=d.extend({block:this,device_id:this.data("deviceid"),vm:{stateEnabed:2,stateDisabed:3,toggleStateBaseURL:this.find("#vms").data("togglestate-baseurl")+this.data("deviceid")+"/"},sites:{stateEnabed:1,stateDisabed:3,toggleStateBaseURL:this.find("#sites").data("togglestate-baseurl")+this.data("deviceid")+"/"}},e),s={initialize:function(){0!==n.block.length&&(n.block.on("click",".togglestate:visible",function(){var e=d(this).closest(".panel").attr("id"),t=d(this).attr("href"),i=d(this).closest("tr").find("td:eq(1)").text();return openConfirmDialog("Are you sure?",[],function(){d.fancybox.close(),"confirm-yes"===d(this).attr("id")&&s.toggleState(t,i,e)}),!1}),n.block.find(".fa-sync").on("click",function(){switch(d(this).closest("a").attr("href")){case"#vms":s.refreshVMs(!0);break;case"#sites":s.refreshSites(!0)}}),n.block.find(".load .progress-bar").each(function(){d(this).css("width",d(this).data("width"))}))},toggleState:function(e,t,i){n.block.isLoading(),d.ajax({url:e,success:function(){showAlert("success","State toggled for "+("vm"===i?"VM":"site")+": "+t),"vms"===i?s.refreshVMs():s.refreshSites()}})},refreshVMs:function(e){(e=void 0!==e&&e)&&n.block.isLoading(),d.getJSON("../getVMs/"+n.device_id,function(e){var a=n.block.find("#vms tbody");a.find("tr:not(.hidden)").remove(),e.sort(function(e,t){return e.Name<t.Name?1:-1}),d.each(e,function(e,t){var i=n.block.find("#vms tr.hidden").clone(),s=t.State===n.vm.stateEnabed?n.vm.stateDisabed:n.vm.stateEnabed;i.find(".name").html(t.Name),i.find(".load .percent").html(t.CPULoad+"%"),i.find(".load .progress-bar").css("width",t.CPULoad+"%"),i.find(".cores").html(t.CoresAmount),i.find(".ram").html(t.MemoryTotal+" "+t.MemoryAllocationUnits),i.find(".mac").html(t.MAC),i.find(".ontime").html(t.GetOnTimeFormatted),i.find(".actions a").attr("href",n.vm.toggleStateBaseURL+t.Name+"/"+s).addClass("btn-"+(t.State===n.vm.stateEnabed?"success":"danger")),i.removeClass("hidden"),i.prependTo(a)})}).always(function(){n.block.isLoading("hide")})},refreshSites:function(e){(e=void 0!==e&&e)&&n.block.isLoading(),d.getJSON("../getSites/"+n.device_id,function(e){var a=n.block.find("#sites tbody");a.find("tr:not(.hidden)").remove(),e.sort(function(e,t){return e.Name<t.Name?1:-1}),d.each(e,function(e,t){var i=n.block.find("#sites tr.hidden").clone(),s=t.State===n.sites.stateEnabed?n.sites.stateDisabed:n.sites.stateEnabed;i.find(".name").html(t.Name),i.find(".actions a").attr("href",n.sites.toggleStateBaseURL+t.Name+"/"+s).addClass("btn-"+(t.State===n.sites.stateEnabed?"success":"danger")),i.removeClass("hidden"),i.prependTo(a)})}).always(function(){n.block.isLoading("hide")})}};return s.initialize(),s},d(".hypervadmin").length&&d(".hypervadmin").hypervadmin()}(jQuery);;!function(n){n.fn.motion=function(e){var i=n.extend({block:this,baseUri:this.data("baseuri"),updateInterval:1e3*this.data("motion-interval"),updateIntervalId:-1},e),t={initialize:function(){0!==i.block.length&&(i.block.on("click",".fa-sync",function(){clearInterval(i.updateIntervalId),i.updateIntervalId=setInterval(function(){t.refreshImage(),t.refreshModifiedTime()},i.updateInterval),t.refreshImage(),t.refreshModifiedTime()}),i.updateIntervalId=setInterval(function(){t.refreshImage(),t.refreshModifiedTime()},i.updateInterval))},refreshImage:function(){var e=i.block.find("a"),t=e.css("background-image").split("?t=");e.css("background-image",t[0]+"?t="+Date.now()+'")')},refreshModifiedTime:function(){n.ajax({url:i.baseUri+"motion/modifiedTime",success:function(e){i.block.find(".subtitle").text(e)}})}};return t.initialize(),t}}(jQuery);;!function(s){s.fn.nowplaying=function(t){this.each(function(){var o=s.extend({block:s(this),updateInterval:1e3*s(this).data("nowplaying-intveral"),updateIntervalId:-1,subsonic:{loading:!1,url:s(this).data("subsonic-url"),password:s(this).data("subsonic-password"),username:s(this).data("subsonic-username"),timeout:5e3},kodi:{loading:!1,url:s(this).data("kodi-url"),urlJSON:s(this).data("kodi-url")+"/jsonrpc",password:s(this).data("kodi-password"),username:s(this).data("kodi-username"),timeout:5e3}},t),l={initialize:function(){o.block.find(".fa-sync").on("click",l.nowPlaying),s("body").on("click",".nowplaying_detail .fa-sync",l.nowPlaying),o.block.find(".fa-chevron-left, .fa-chevron-right").click(function(){l.rotate(s(this).hasClass("fa-chevron-left")?"left":"right")}),l.nowPlaying(!0)},nowPlaying:function(t){(t=void 0!==t&&t)||s(".nowplaying").isLoading(),l.setInterval(),o.block.find(".panel-heading button.fa-chevron-left, .panel-heading button.fa-chevron-right").addClass("disabled"),o.block.find(".player.nothing-playing").hide(),o.block.find(".player:not(.nothing-playing)").remove(),l.subsonic.nowPlaying(),l.kodi.nowPlaying();var i=window.setInterval(function(){t||!1!==o.kodi.loading||!1!==o.subsonic.loading||(s(".nowplaying").isLoading("hide"),clearInterval(i))},100)},nowPlayingCallback:function(){var t;!1===o.kodi.loading&&!1===o.subsonic.loading&&(0<(t=o.block.find(".player:not(.nothing-playing)").length)?o.block.find(".player.nothing-playing").hide():(o.block.find(".player.nothing-playing").show(),o.block.find(".player.nothing-playing").find(".image").css("background-image","url(img/icons/unknown.jpg)")),t<=1?o.block.find(".panel-heading button.fa-chevron-left, .panel-heading button.fa-chevron-right").addClass("disabled"):o.block.find(".panel-heading button.fa-chevron-left, .panel-heading button.fa-chevron-right").removeClass("disabled"),t=o.block.find(".player:visible").hasClass("kodi")?"Kodi":"Subsonic",o.block.find("h4").html(t))},setInterval:function(){clearInterval(o.updateIntervalId),o.updateIntervalId=setInterval(function(){o.block.find(".player:not(.nothing-playing)").remove(),l.subsonic.nowPlaying(),l.kodi.nowPlaying()},o.updateInterval)},rotate:function(t){var i=o.block.find(".player:visible").index(),n="right"===t?1:-1,a=1,t=o.block.find(".player:eq("+(i+n)+")");1!==t.length||t.hasClass("nothing-playing")?t.hasClass("nothing-playing")&&(a=o.block.find(".player").length-1):a=i+n,i!==a&&o.block.find(".player:eq("+i+")").fadeOut("fast",function(){o.block.find(".player:eq("+a+")").fadeIn("fast",function(){var t=o.block.find(".player:visible").hasClass("kodi")?"Kodi":"Subsonic";o.block.find("h4").html(t)}).css("display","block")})},createPlayer:function(t){var i=o.block.find(".player.nothing-playing").clone(),n=i.find("#nowplaying_detail").attr("id","nowplaying_detail_"+t.index);i.removeClass("nothing-playing").addClass(t.type),i.find(".item").attr("data-fancybox",""),i.find(".item .image").css("background-image","url("+t.bgImage+")").parent().attr({title:s(this).attr("title"),href:"#nowplaying_detail_"+t.index}),i.find(".title").html(t.title),i.find(".subtitle").html(t.subtitle),n.find("h4").html(t.title),n.find(".track").html(t.track),n.find(".album").html(t.album),n.find(".year").html(t.year),n.find(".genre").html(t.genre),n.find(".duration").html(t.duration),n.find(".bitrate").html(t.bitrate),n.find(".playcount").html(t.playCount),n.find(".lastplayed").html(t.lastPlayed+" minutes ago"),0!==o.block.find(".player:not(.nothing-playing):visible").length?i.hide():i.show(),i.appendTo(o.block.find(".panel-body"))},subsonic:{nowPlaying:function(){o.subsonic.loading=!0,s.ajax({url:l.subsonic.getURL("getNowPlaying"),timeout:o.subsonic.timeout,success:function(t){t=s(t).find("entry");0!==t.length&&t.each(function(t,i){var n=l.subsonic.getURL("getCoverArt",{id:s(this).attr("coverArt")}),a=Math.floor(s(this).attr("duration")/60)+":"+s(this).attr("duration")%60;l.createPlayer({type:"subsonic",index:t,bgImage:n,title:s(this).attr("artist"),subtitle:s(this).attr("title"),track:s(this).attr("track"),album:s(this).attr("album"),year:s(this).attr("year"),genre:s(this).attr("genre"),duration:a,bitrate:s(this).attr("bitRate"),playCount:s(this).attr("playCount"),lastPlayed:s(this).attr("minutesAgo")})})},complete:function(){o.subsonic.loading=!1,l.nowPlayingCallback()}})},getSalt:function(){return Math.random().toString(36).substring(7)},getURL:function(t,i){var n=l.subsonic.getSalt(),a=SparkMD5.hash(o.subsonic.password+n),e=o.subsonic.url+"rest/"+t+".view?u="+o.subsonic.username+"&t="+a+"&s="+n+"&v=1.14.0&c=chell";return s.each(i,function(t,i){e+="&"+t+"="+i}),e}},kodi:{nowPlaying:function(){o.kodi.loading=!0;var t=l.kodi.getPlayerId();void 0!==t&&s.ajax({url:o.kodi.urlJSON,type:"POST",async:!1,contentType:"application/json",data:JSON.stringify({id:"getnowplaying",jsonrpc:"2.0",method:"Player.GetItem",params:{properties:["title","showtitle","artist","thumbnail"],playerid:t}}),timeout:o.kodi.timeout,beforeSend:function(t){t.setRequestHeader("Authorization","Basic "+btoa(o.kodi.username+":"+o.kodi.password))},success:function(t){var i,n;""!==s.trim(t.result.item.title)&&(i=t.result.item.title,n="",void 0!==t.result.item.showtitle?i=t.result.item.showtitle:void 0!==t.result.item.artist&&(i=t.result.item.artist,n=t.result.item.title),l.createPlayer({type:"kodi",index:99,bgImage:l.kodi.getImage(t.result.item.thumbnail),title:i,subtitle:n}))}}),o.kodi.loading=!1,l.nowPlayingCallback()},getPlayerId:function(){s.ajax({url:o.kodi.urlJSON,type:"POST",async:!1,contentType:"application/json",data:JSON.stringify({id:"activaplayers",jsonrpc:"2.0",method:"Player.GetActivePlayers"}),timeout:o.kodi.timeout,beforeSend:function(t){t.setRequestHeader("Authorization","Basic "+btoa(o.kodi.username+":"+o.kodi.password))},success:function(t){if(t.result[0])return t.result[0].playerid}})},getImage:function(t){s.ajax({url:o.kodi.urlJSON,type:"POST",async:!1,contentType:"application/json",data:JSON.stringify({id:"preparedl",jsonrpc:"2.0",method:"Files.PrepareDownload",params:{path:t}}),timeout:o.kodi.timeout,beforeSend:function(t){t.setRequestHeader("Authorization","Basic "+btoa(o.kodi.username+":"+o.kodi.password))},success:function(t){return o.kodi.url+"/"+t.result.details.path}})}}};return l.initialize(),l})}}(jQuery);;!function(i){i.fn.opcache=function(t){var a=i.extend({block:this,charts:[{name:"Memory",legendNames:["Used","Free","Wasted"],unitIndicator:"MB",active:!0},{name:"Keys",legendNames:["Cached","Free"],unitIndicator:!1,active:!1},{name:"Hits",legendNames:["Misses","Hits"],unitIndicator:!1,active:!1},{name:"Restarts",legendNames:["Memory","Manual","Keys"],unitIndicator:!1,active:!1}]},t),n={initialize:function(){0!==a.block.length&&(i.getJSON("opcache/dataset",function(t){a.charts[0].data=t.memory,a.charts[1].data=t.keys,a.charts[2].data=t.hits,a.charts[3].data=t.restarts,n.initializeChart(a.charts[0])}),a.block.find(".fa-chevron-right, .fa-chevron-left").off().on("click",function(){var t=1,e=a.charts.find(function(t){return!0===t.active}),e=a.charts.indexOf(e),t=e+(t=i(this).hasClass("fa-chevron-left")?-1:t);t>=a.charts.length?t=0:t<0&&(t=a.charts.length-1),a.charts[e].active=!1,a.charts[t].active=!0,a.block.find(".panel-body h4").text(a.charts[t].name),n.initializeChart(a.charts[t])}))},initializeChart:function(e){void 0===e&&(e=a.charts[0]);var t=new Chartist.Pie(".panel.opcache .graph",{series:e.data},{donut:!0,donutWidth:30,showLabel:!0,plugins:[Chartist.plugins.legend({position:"bottom",legendNames:e.legendNames})],labelInterpolationFnc:function(t){return t+(e.unitIndicator?" "+e.unitIndicator:"")}});t.on("draw",n.animateChart),t.on("created",function(){setTimeout(function(){a.block.find(".ct-label ").fadeTo("fast",1)},1e3)})},animateChart:function(t){var e,a;"slice"===t.type&&(e=t.element._node.getTotalLength(),t.element.attr({"stroke-dasharray":e+"px "+e+"px"}),a={"stroke-dashoffset":{id:"anim"+t.index,dur:750,from:-e+"px",to:"0px",easing:Chartist.Svg.Easing.easeOutQuint,fill:"freeze"}},0!==t.index&&(a["stroke-dashoffset"].begin="anim"+(t.index-1)+".end"),t.element.attr({"stroke-dashoffset":-e+"px"}),t.element.animate(a,!1))}};return n.initialize(),n}}(jQuery);;!function(l){l.fn.phpsysinfo=function(t){this.each(function(){var a=l.extend({url:l(this).data("distro-icon-base"),block:l(this),diskspaceunits:["B","KB","MB","GB","TB"],setBadges:!1},t),o={initialize:function(){0!==a.block.length&&("setAppBadge"in navigator&&"clearAppBadge"in navigator&&(a.setBadges=!0),a.block.find(".fa-sync").off().on("click",function(){a.block.hasClass("processes")?o.getPsStatus():o.getAll()}),a.block.hasClass("sysinfo")&&o.getAll(!0))},getAll:function(t){(t=void 0!==t&&t)||l(".sysinfo, #hardware:visible, .harddisks, .processes").isLoading(),l.ajax({url:"phpsysinfo/",dataType:"json",success:function(t){var e=l("#hardware"),s=l(".sysinfo"),i=l(".harddisks");o.setSysinfo(t,s),o.setCPUCores(t,e),o.setNetwork(t,e),o.setRAM(t,s),o.setDisks(t,i),o.setUpdateNotifier(t,s),o.setPsStatus(t)},complete:function(){l(".sysinfo, #hardware:visible, .harddisks, .processes").isLoading("hide")}})},setSysinfo:function(t,e){e.find("div.host").html(t.Vitals["@attributes"].Hostname),e.find("div.distro span").html(t.Vitals["@attributes"].Distro),e.find("div.distro div.icon").css("background-image","url('"+a.url+"gfx/images/"+t.Vitals["@attributes"].Distroicon+"')"),e.find("div.kernel").html(t.Vitals["@attributes"].Kernel);var s=new Date;s.setSeconds(s.getSeconds()-Math.floor(t.Vitals["@attributes"].Uptime)),void 0!==a.block.find("div.time").data("tinyTimer")&&clearInterval(a.block.find("div.time").data("tinyTimer").interval),e.find("div.time").tinyTimer({from:s,format:"%d days %0h:%0m:%0s"})},setCPUCores:function(o,d){d.find(".cpu-model .value").html(o.Hardware.CPU.CpuCore[0]["@attributes"].Model),d.find(".motherboard .value").html(o.Hardware["@attributes"].Name),l.each(o.Hardware.CPU.CpuCore,function(s,t){var i,e=Math.round(t["@attributes"].CpuSpeed/10)/100+" GHz",a=Math.round(t["@attributes"].CpuSpeedMin/10)/100+" GHz",n=Math.round(t["@attributes"].CpuSpeedMax/10)/100+" GHz",r="Core "+s;l.each(o.MBInfo.Temperature.Item,function(t,e){-1!==l.trim(e["@attributes"].Label.toLowerCase()).indexOf("core "+s)&&(i=e["@attributes"].Value+" &deg;"+o.Options["@attributes"].tempFormat.toUpperCase())});t=d.find("li.cpu-cores:not(.clone)").eq(s);0===t.length&&((t=d.find("li.cpu-cores.clone").clone()).removeClass("hidden clone"),t.insertBefore(d.find(".network"))),i?t.find(".core-temp").html(i):t.find(".core-temp, .core-temp-label").remove(),t.find(".cpu-core").html(r),t.find(".core-current").html(e),t.find(".core-min").html(a),t.find(".core-max").html(n)})},setNetwork:function(t,n){l.isArray(t.Network.NetDevice)||(t.Network.NetDevice=new Array(t.Network.NetDevice)),l.each(t.Network.NetDevice,function(t,e){var s,i,a;void 0!==e["@attributes"]&&(s=o.getFormattedSize(e["@attributes"].RxBytes),i=o.getFormattedSize(e["@attributes"].TxBytes),a=e["@attributes"].Info.split(";"),0===(t=n.find(".lan-stats > div:not(.clone)").eq(t)).length&&((t=n.find(".lan-stats > .clone").clone()).removeClass("hidden clone"),t.appendTo(n.find(".lan-stats"))),t.find(".lan-name").html(e["@attributes"].Name),t.find(".lan-mac").html(a[0]),t.find(".lan-ip").html(a[1]),t.find(".lan-speed").html(a[a.length-1]),t.find(".lan-rx").html(s),t.find(".lan-tx").html(i))})},setRAM:function(t,e){e.find("div.ram").find(".progress-bar").css("width",t.Memory["@attributes"].Percent+"%"),e.find("div.ram").find(".percent span").html(t.Memory["@attributes"].Percent),void 0!==t.Memory.Swap?(e.find("div.swap").find(".progress-bar").css("width",t.Memory.Swap["@attributes"].Percent+"%"),e.find("div.swap").find(".percent span").html(t.Memory.Swap["@attributes"].Percent)):e.find("div.swap").closest("li").hide()},setDisks:function(t,r){t.FileSystem.Mount.sort(function(t,e){return t["@attributes"].MountPoint<e["@attributes"].MountPoint?-1:1}),l.each(t.FileSystem.Mount,function(t,e){var s=r.find("li:not(.clone)").eq(t);0===s.length&&((s=r.find("li.clone").clone()).removeClass("hidden clone"),s.appendTo(r.find("ul")));var i=parseInt(e["@attributes"].Percent)+(void 0!==e["@attributes"].Buffers?parseInt(e["@attributes"].Buffers):0)+"%",a=o.getFormattedSize(e["@attributes"].Total),n=o.getFormattedSize(e["@attributes"].Free),t=o.getFormattedSize(e["@attributes"].Used);s.find(".name").html(e["@attributes"].MountPoint),s.find(".progress-bar").css("width",i),s.find(".percent").html(i),s.find(".progress").addClass("bs-tooltip").attr("title","Total: "+a+"\nFree: "+n+"\nUsed: "+t),90<e["@attributes"].Percent?s.find(".progress-bar").addClass("progress-bar-danger"):70<e["@attributes"].Percent?s.find(".progress-bar").addClass("progress-bar-warning"):50<e["@attributes"].Percent?s.find(".progress-bar").addClass("progress-bar-info"):s.find(".progress-bar").addClass("progress-bar-success")})},getFormattedSize:function(t){for(var e=0;1024<t;)t/=1024,e++;return Math.round(100*t)/100+" "+a.diskspaceunits[e]},setUpdateNotifier:function(t,e){if(void 0!==t.Plugins.Plugin_UpdateNotifier){var s=parseInt(t.Plugins.Plugin_UpdateNotifier.UpdateNotifier.packages),i=parseInt(t.Plugins.Plugin_UpdateNotifier.UpdateNotifier.security),t=(s=isNaN(s)?0:s)+(i=isNaN(i)?0:i);if(e.find(".update .packages .value").html(s),e.find(".update .security .value").html(i),0<t&&a.setBadges)return void navigator.setAppBadge(t)}a.setBadges&&navigator.clearAppBadge()},getPsStatus:function(){l(".processes").isLoading(),l.ajax({url:"phpsysinfo/index/psstatus",dataType:"json",success:function(t){o.setPsStatus(t)},complete:function(){l(".processes").isLoading("hide")}})},setPsStatus:function(t){t.Plugins.Plugin_PSStatus.Process.sort(function(t,e){return t["@attributes"].Name.toLowerCase()<e["@attributes"].Name.toLowerCase()?-1:1}),l.each(t.Plugins.Plugin_PSStatus.Process,function(t,e){var s=l("<li />",{class:"list-group-item col-xs-12 col-md-12"}),i=l("<div />",{class:"col-xs-10"}),a=l("<div />",{class:"col-xs-2 text-right"}),n=l("<span />",{class:"label"});i.html(e["@attributes"].Name.replace(".*","")),i.appendTo(s),"1"===e["@attributes"].Status?(n.html("On"),n.addClass("label-success")):(n.html("Off"),n.addClass("label-danger")),n.appendTo(a),a.appendTo(s),l("div.processes li div:contains('"+e["@attributes"].Name.replace(".*","")+"')").parent().remove(),s.appendTo(l("div.processes ul"))})}};return o.initialize(),o})}}(jQuery);;!function(t){t.fn.pihole=function(e){var n=t.extend({block:this,url:t(this).data("pihole-url"),charts:[{name:"Queries today",legendNames:["Cached","Not cached","Blocked"],active:!0}]},e),a={initialize:function(){0!==n.block.length&&(n.block.on("click",".fa-sync",function(){a.refresh()}),a.refresh())},refresh:function(){t.getJSON(n.url+"api.php?summaryRaw",function(e){n.charts[0].data=[e.queries_cached,e.dns_queries_today-e.queries_cached,e.ads_blocked_today],a.initializeChart(n.charts[0])})},initializeChart:function(t){void 0===t&&(t=n.charts[0]);var e=new Chartist.Pie(".panel.pihole .graph",{series:t.data},{donut:!0,donutWidth:30,showLabel:!0,plugins:[Chartist.plugins.legend({position:"bottom",legendNames:t.legendNames})],labelInterpolationFnc:function(e){return e+(t.unitIndicator?" "+t.unitIndicator:"")}});e.on("draw",a.animateChart),e.on("created",function(){setTimeout(function(){n.block.find(".ct-label ").fadeTo("fast",1)},1e3)})},animateChart:function(e){var t,n;"slice"===e.type&&(t=e.element._node.getTotalLength(),e.element.attr({"stroke-dasharray":t+"px "+t+"px"}),n={"stroke-dashoffset":{id:"anim"+e.index,dur:750,from:-t+"px",to:"0px",easing:Chartist.Svg.Easing.easeOutQuint,fill:"freeze"}},0!==e.index&&(n["stroke-dashoffset"].begin="anim"+(e.index-1)+".end"),e.element.attr({"stroke-dashoffset":-t+"px"}),e.element.animate(n,!1))}};return a.initialize(),a}}(jQuery);;!function(n){n.fn.pulseway=function(e){var i=n.extend({block:n(this),systems:n(this).data("systems").split(","),updateInterval:1e3*this.data("updateinterval"),updateIntervalId:-1},e),t={initialize:function(){i.block.find(".fa-sync").click(function(){t.update(!1)}),i.updateIntervalId=setInterval(t.update,i.updateInterval),t.update(!0)},update:function(e){(e=void 0!==e&&e)||(i.block.isLoading(),window.clearInterval(i.updateIntervalId)),n.ajax({url:"pulseway",dataType:"json",success:function(e){i.block.find(".system:not(.hidden)").remove(),n.each(e,function(e,t){var n;t&&((n=i.block.find(".system.hidden").clone()).find(".name span").text(t.name).attr("title",t.description),n.find(".icon i").attr({class:"fa fa-power-off text-"+(t.is_online?"success":"danger"),title:t.is_online?"Online":"Offline"}),n.find(".value span.uptime").text(t.uptime),-1!==t.uptime.indexOf("Offline")&&n.find(".value span.uptimelabel").hide(),n.removeClass("hidden"),n.appendTo(i.block.find("ul")))})},complete:function(){i.updateIntervalId=window.setInterval(t.update,i.updateInterval),i.block.isLoading("hide")}})}};return t.initialize(),t}}(jQuery);;!function(t){t.fn.rcpu=function(i){var e=t.extend({block:t(this),iframe:t(this).find("iframe")},i),n={initialize:function(){e.iframe=e.block.find("iframe"),e.block.isLoading(),e.iframe.on("load",function(){new ResizeObserver(n.setHeight).observe(e.iframe.contents().find("body")[0]),e.block.isLoading("hide")})},setHeight:function(){var i=e.iframe.contents().height();e.block.find(".panel-body").height(i),e.block.parent().prev().find(".processes ul").height(i+15),window.setTimeout(n.setVisibility,0)},setVisibility:function(){e.iframe.animate({opacity:1},"fast")}};return n.initialize(),n}}(jQuery);;!function(e){e.fn.roborock=function(t){var n=e.extend({block:e(this),updateInterval:1e3*e(this).data("update-interval"),updateIntervalId:-1},t),a={initialize:function(){n.block.find(".fa-sync").click(function(){a.update(!1)}),n.block.find(".start-stop").click(a.start_stop),a.update(!0)},update:function(t){(t=void 0!==t&&t)||(n.block.isLoading(),window.clearInterval(n.updateIntervalId)),e.ajax({url:"roborock",dataType:"json",success:function(t){n.block.find(".state").text(t.state),n.block.find(".battery").text(t.battery+"%"),n.block.find(".fan").text(t.fan),n.block.find(".area").html(t.area+" m<sup>2</sup>"),n.block.find(".waterbox").html("<i class='fa fa-power-off "+("false"!==t.waterbox_attached?"text-success":"text-danger")+"'></i>");var a,e=n.block.find(".cleaningtime");"Cleaning"==t.state?(void 0!==e.data("tinyTimer")&&clearInterval(e.data("tinyTimer").interval),a=t.time.split(":"),e.html(3600*parseInt(a[0])+60*parseInt(a[1])+parseInt(a[2])),initializeTinyTimer(e),n.block.find(".start-stop").removeClass("fa-play").addClass("fa-stop")):(clearInterval(e.data("tinyTimer")?.interval),e.html(t.time),n.block.find(".start-stop").removeClass("fa-stop").addClass("fa-play"))},complete:function(){n.updateIntervalId=window.setInterval(a.update,n.updateInterval),n.block.isLoading("hide")}})},start_stop:function(){var t=e(this).hasClass("fa-play");n.block.isLoading(),e.ajax({url:"roborock/"+(t?"start":"stop"),success:function(){showAlert("success","Roborock "+(t?"started":"stopped")+" cleaning")},complete:function(){n.block.isLoading("hide"),a.update()}})}};return a.initialize(),a}}(jQuery);;!function(s){s.fn.sickrage=function(e){var r=s.extend({block:this,apiKey:this.data("sickrage-apikey"),baseUrl:this.data("sickrage-url")},e),t={initialize:function(){0!==r.block.length&&(r.block.find(".fa-sync").on("click",function(){t.refresh()}),t.refresh(!0))},refresh:function(e){e||r.block.isLoading();var a=r.block.find("#today .list-group"),i=r.block.find("#soon .list-group");s.ajax({url:t.url("future","today|soon"),dataType:"json",success:function(e){e=e.data,a.find("a:not(.hidden)").remove(),i.find("a:not(.hidden)").remove(),s.each(e.today,function(e,n){t.createItems(a,n)}),s.each(e.soon,function(e,n){t.createItems(i,n)})},complete:function(){e||r.block.isLoading("hide"),a.find(".list-group-item:not(.hidden)").length?r.block.find("a:eq(0)").attr("data-toggle","tab"):(r.block.find("a[href='#soon']").tab("show"),r.block.find("a[href='#today']").parent().addClass("disabled"),r.block.find("a[href='#today']").attr("data-toggle",""))}})},createItems:function(e,n){var a=e.find("a.hidden").clone(),i=a.find(".episode"),t=r.block.find(".sickrage-detail").clone(),o="S"+zeropad(n.season,2)+"E"+zeropad(n.episode,2),d="t"+n.tvdbid+"-"+o;i.html(o+" | "+n.show_name),t.attr("data-fancybox",e.attr("id")),t.attr("id",d),t.find("h4").html(n.show_name),t.find(".plot").html(n.ep_plot),t.find(".season").html(zeropad(n.season,2)),t.find(".episode").html(zeropad(n.episode,2)),t.find(".episodename").html(n.ep_name),t.find(".airdate").html(n.airdate),a.on("click",function(){return s.fancybox.open({src:"#"+d,margin:[0]}),!1}),t.appendTo(a),a.removeClass("hidden"),a.prependTo(e)},url:function(e,n){return r.baseUrl+"api/"+r.apiKey+"/?cmd="+e+"&type="+n}};t.initialize()}}(jQuery);;!function(d){d.fn.snmp=function(i){var a=d.extend({block:d(this),updateInterval:1e3*d(this).data("update-interval"),updateIntervalId:-1},i),n={initialize:function(){0!==a.block.length&&(a.block.find(".fa-chevron-left, .fa-chevron-right").click(function(){var i=d(this).hasClass("fa-chevron-right")?1:-1,t=a.block.find(".host:visible"),n=t.index(),i=1===(e=a.block.find(".host:eq("+(n+i)+")")).length?n+i:0,e=a.block.find(".host:eq("+i+")");n!==i&&t.fadeOut("fast",function(){e.fadeIn("fast").css("display","block")})}),a.block.find("a").click(function(){d(this).attr("href","/portal/snmp/details/"+a.block.find(".host:visible").data("id"))}),a.block.find(".fa-sync").click(function(){n.update()}),a.updateIntervalId=window.setInterval(n.update,a.updateInterval),a.block.find(".host").each(function(i,t){d.get("snmp/hostcontent/"+d(t).data("id")+"/hidden-xs",function(i){d(t).html(i),initializeTinyTimer(d(t).find(".time"))})}))},update:function(t){a.block.isLoading(),void 0===t&&(t=a.block.find(".host:visible")),window.clearInterval(a.updateIntervalId);var i=t.find("div.time");void 0!==i.data("tinyTimer")&&clearInterval(i.data("tinyTimer").interval),d.get("snmp/hostcontent/"+t.data("id")+(t.find("ul:visible").length?"":"/hidden-xs"),function(i){t.html(i),initializeTinyTimer(t.find(".time"))}),a.updateIntervalId=window.setInterval(n.update,a.updateInterval),a.block.isLoading("hide")}};return n.initialize(),n}}(jQuery);;!function(r){r.fn.speedtest=function(t){var e=r.extend({block:this,testOrder:this.data("speedtest-testorder"),uploadTime:this.data("speedtest-uploadtime"),downloadTime:this.data("speedtest-downloadtime"),getISPIP:this.data("speedtest-getispip"),distanceUnit:this.data("speedtest-distance"),telemetry:this.data("speedtest-telemetry"),animationFrameId:-1,colors:{meterBk:"#E0E0E0",dlColor:"#6060AA",ulColor:"#309030",pingColor:"#AA6060",jitColor:"#AA6060",progColor:"#EEEEEE"}},t),o=null,i=null,a={initialize:function(){0!==e.block.length&&(e.block.find(".fa-play, .fa-stop").on("click",function(){r(this).toggleClass("fa-play fa-stop"),a.startStop()}),e.block.find("h4").click(function(){e.block.find(".panel-body").is(":visible")&&a.initUI()}),window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){setTimeout(t,1e3/60)},setTimeout(a.initUI,100))},initializeIframe:function(){var a=e.block.closest(".panel.with-nav-tabs"),t=new Chartist.Bar("#ct-chart",{labels:-1!=e.block.data("labels").toString().indexOf(",")?e.block.data("labels").split(","):[e.block.data("labels")],series:[-1!=e.block.data("dl").toString().indexOf(",")?e.block.data("dl").split(","):[e.block.data("dl")],-1!=e.block.data("ul").toString().indexOf(",")?e.block.data("ul").split(","):[e.block.data("ul")],-1!=e.block.data("ping").toString().indexOf(",")?e.block.data("ping").split(","):[e.block.data("ping")],-1!=e.block.data("jitter").toString().indexOf(",")?e.block.data("jitter").split(","):[e.block.data("jitter")]]},{horizontalBars:!0,height:"650px",plugins:[Chartist.plugins.legend({legendNames:["Download","Upload","Ping","Jitter"]})]});a.find(".nav-tabs a").click(function(){setTimeout(function(){t.update()},250)}),a.find(".paginator a:not([href='#'])").click(function(){var t=r(this).attr("href"),e=t.indexOf("stats/"),o=a.find(".nav-tabs li.active a").attr("href").replace("#","")+"/",i=t.substr(t.lastIndexOf("/")+1),i=t.substr(0,e+6)+o+i;r(this).attr("href",i)})},drawMeter:function(t,e,o,i,a,r){var l=t.getContext("2d"),n=window.devicePixelRatio||1,s=t.clientWidth*n,d=t.clientHeight*n,n=.0055*d;t.width==s&&t.height==d?l.clearRect(0,0,s,d):(t.width=s,t.height=d),l.beginPath(),l.strokeStyle=o,l.lineWidth=16*n,l.arc(t.width/2,t.height-58*n,Math.abs(t.height/1.8-l.lineWidth),1.1*-Math.PI,.1*Math.PI),l.stroke(),l.beginPath(),l.strokeStyle=i,l.lineWidth=16*n,l.arc(t.width/2,t.height-58*n,Math.abs(t.height/1.8-l.lineWidth),1.1*-Math.PI,e*Math.PI*1.2-1.1*Math.PI),l.stroke(),void 0!==a&&(l.fillStyle=r,l.fillRect(.3*t.width,t.height-16*n,.4*t.width*a,4*n))},startStop:function(){null!=o?(o.postMessage("abort"),i=o=null,cancelAnimationFrame(e.animationFrameId),a.initUI()):(a.frame(),(o=new Worker("vendor/speedtest/speedtest_worker.min.js?t="+Date.now())).postMessage("start "+JSON.stringify({url_dl:"../../speedtest/garbage",url_ul:"../../speedtest/empty",url_ping:"../../speedtest/empty",url_getIp:"../../speedtest/getIP",url_telemetry:"../../speedtest/telemetry",telemetry_level:e.telemetry,time_ul_max:e.uploadTime,time_dl_max:e.downloadTime,time_auto:!1,getIp_ispInfo:e.getISPIP,getIp_ispInfo_distance:e.distanceUnit})),o.onmessage=function(t){4<=(i=JSON.parse(t.data)).testState&&(o=null,a.updateUI(!0),cancelAnimationFrame(e.animationFrameId),e.block.find(".fa-play, .fa-stop").removeClass("fa-stop").addClass("fa-play"))})},mbpsToAmount:function(t){return 1-1/Math.pow(1.3,Math.sqrt(t))},msToAmount:function(t){return 1-1/Math.pow(1.08,Math.sqrt(t))},oscillate:function(){return 1+.02*Math.sin(Date.now()/100)},initUI:function(){a.drawMeter(r("#dlMeter")[0],0,e.colors.meterBk,e.colors.dlColor,0),a.drawMeter(r("#ulMeter")[0],0,e.colors.meterBk,e.colors.ulColor,0),a.drawMeter(r("#pingMeter")[0],0,e.colors.meterBk,e.colors.pingColor,0),a.drawMeter(r("#jitMeter")[0],0,e.colors.meterBk,e.colors.jitColor,0),r("#dlText").textContent="",r("#ulText").textContent="",r("#pingText").textContent="",r("#jitText").textContent="",r("#ip").textContent=""},frame:function(){e.animationFrameId=requestAnimationFrame(a.frame),a.updateUI()},updateUI:function(t){o&&o.postMessage("status"),(i||t)&&(t=i.testState,r("#ip").text(i.clientIp),r("#dlText").text(1==t&&0==i.dlStatus?"...":i.dlStatus),a.drawMeter(r("#dlMeter")[0],a.mbpsToAmount(Number(i.dlStatus*(1==t?a.oscillate():1))),e.colors.meterBk,e.colors.dlColor,Number(i.dlProgress),e.colors.progColor),r("#ulText").text(3==t&&0==i.ulStatus?"...":i.ulStatus),a.drawMeter(r("#ulMeter")[0],a.mbpsToAmount(Number(i.ulStatus*(3==t?a.oscillate():1))),e.colors.meterBk,e.colors.ulColor,Number(i.ulProgress),e.colors.progColor),r("#pingText").text(i.pingStatus),a.drawMeter(r("#pingMeter")[0],a.msToAmount(Number(i.pingStatus*(2==t?a.oscillate():1))),e.colors.meterBk,e.colors.pingColor,Number(i.pingProgress),e.colors.progColor),r("#jitText").text(i.jitterStatus),a.drawMeter(r("#jitMeter")[0],a.msToAmount(Number(i.jitterStatus*(2==t?a.oscillate():1))),e.colors.meterBk,e.colors.jitColor,Number(i.pingProgress),e.colors.progColor))}};return r("body#iframe").length||a.initialize(),a},r("#ct-chart").length&&r("#ct-chart").speedtest().initializeIframe()}(jQuery);;!function(i){i.fn.transmission=function(t){var r=i.extend({defaultData:{type:"POST",beforeSend:function(t){t.setRequestHeader("Authorization","Basic "+btoa(r.block.data("transmission-username")+":"+r.block.data("transmission-password"))),t.setRequestHeader("X-Transmission-Session-Id",r.transmissionSessionId)},statusCode:{409:function(t,e,s){r.transmissionSessionId=t.getResponseHeader("X-Transmission-Session-Id")}},url:this.data("transmission-url")+"rpc/"},block:this,transmissionSessionId:-1,updateInterval:1e3*this.data("transmission-update-interval"),updateIntervalId:-1},t),o={getTorrents:function(a){(a=void 0!==a&&a)||r.block.isLoading(),clearInterval(r.updateIntervalId),r.updateIntervalId=setInterval(function(){o.getTorrents(!1)},r.updateInterval),r.block.find(".fa-sync").off().on("click",function(){o.getTorrents(!1),i(this).blur()});var t=r.defaultData;return t.data='{"method":"torrent-get", "arguments":{"fields":["id", "name", "percentDone", "status"]}}',t.complete=function(t,e){if(200===t.status){var s,n=i.parseJSON(t.responseText);r.block.find("li").not(".hidden").remove(),0===n.arguments.torrents.length&&((s=r.block.find("li.hidden").clone()).removeClass("hidden"),s.find(".torrentname").html("No torrents found"),s.find(".torrentname").removeClass("col-xs-4"),s.find(".torrentprogress, .torrentactions").remove(),s.appendTo(i(".transmission ul"))),i.each(n.arguments.torrents,function(t,e){var s=r.block.find("li.hidden").clone();s.attr("data-id",e.id),s.removeClass("hidden"),s.find(".torrentname").html(e.name),s.find(".torrentname").attr("title",e.name),e.percentDone=Math.round(1e4*e.percentDone)/100,s.find(".torrentprogress .percent").html(e.percentDone+"%"),s.find(".torrentprogress .progress-bar").width(e.percentDone+"%"),4===e.status?(s.find(".torrentactions .status").removeClass("fa-play"),s.find(".torrentactions .status").addClass("fa-pause")):0===e.status&&(s.find(".torrentactions .status").removeClass("fa-pause"),s.find(".progress-bar").removeClass("progress-bar-success").addClass("progress-bar-primary"),s.find(".torrentactions .status").addClass("fa-play")),s.find(".torrentactions .status").off().on("click",function(){o.startStopTorrents(i(this).closest("li").data("id"))}),s.find(".torrentactions .fa-trash-alt").off().on("click",function(){openConfirmDialog("Delete torrent?",[],function(){i.fancybox.close(),"confirm-yes"===i(this).attr("id")&&o.removeTorrents(s.data("id"))})}),s.appendTo(i(".transmission ul"))})}else if(409===t.status)return a||r.block.isLoading("hide"),void o.getTorrents(a);a||r.block.isLoading("hide")},i.ajax(t),self},startStopTorrents:function(s){var t=r.defaultData;t.data='{"method":"torrent-'+(i("li[data-id="+s+"] button.status:first-child").hasClass("fa-pause")?"stop":"start-now")+'", "arguments":{"ids":['+s+"]}}",t.complete=function(t,e){409===t.status?o.startTorrents(s):200===t.status&&"success"===i.parseJSON(t.responseText).result&&(i("li[data-id="+s+"] button.status").toggleClass("fa-pause fa-play"),i("li[data-id="+s+"] .progress-bar").toggleClass("progress-bar-success progress-bar-primary"))},i.ajax(t)},removeTorrents:function(s){var t=r.defaultData;t.data='{"method":"torrent-remove", "arguments":{"ids":['+s+']}, "delete-local-data": true}',t.complete=function(t,e){409===t.status?o.removeTorrents(s):200===t.status&&"success"===i.parseJSON(t.responseText).result&&(i("li[data-id="+s+"]").remove(),o.getTorrents(!1))},i.ajax(t)}};return 0!==r.block.length&&o.getTorrents(!0),o}}(jQuery);;!function(o){o.fn.verisure=function(e){var n=o.extend({block:o(this),updateInterval:1e3*o(this).data("update-interval"),updateIntervalId:-1},e),i={initialize:function(){0!==n.block.length&&(o.fancybox.defaults.btnTpl.take_photo="<button data-fancybox-take-photo class='fancybox-button fa fa-camera' title='Take photo'></button>",o("body").on("click","[data-fancybox-take-photo]",function(){i.take_photo(encodeURI(o.fancybox.getInstance().current.deviceLabel))}),o("body").on("click","#verisure_device_select button",function(){i.take_photo(encodeURI(o(this).data("deviceLabel")))}),o("body").on("click","#verisure_set_armstate button",function(){i.set_arm_state(o(this).data("state"))}),n.block.find(".fa-sync").click(function(){i.update(!1)}),n.block.find(".fa-image").click(function(){i.photos(!0)}),n.block.find(".fa-camera").click(i.select_device),n.block.find(".top button").click(function(){o.fancybox.open({src:"#verisure_set_armstate"})}),i.photos(),i.update(!0))},update:function(e){(e=void 0!==e&&e)||(n.block.isLoading(),window.clearInterval(n.updateIntervalId)),o.ajax({url:"verisure",dataType:"json",success:function(e){var a=new Date(e.armState.date),t=new RegExp("_","g"),s=e.armState.statusType.toLowerCase().capitalize().replace(t," "),t=e.armState.changedVia.toLowerCase().capitalize().replace(t," ");n.block.find(".status").html(s),n.block.find(".name").html(void 0!==e.armState.name?e.armState.name:"Unknown"),n.block.find(".date").html(a.getDate()+"-"+zeropad(a.getMonth()+1,2)+"-"+a.getFullYear()+" "+zeropad(a.getHours(),2)+":"+zeropad(a.getMinutes(),2)),n.block.find(".via").html(t),i.set_arm_state_buttons(e.armState.statusType),o.each(e.climateValues,function(e,a){var t=a.deviceLabel.replace(/\s/g,"_"),s=n.block.find("#"+t);0===s.length&&((s=o(".temps .clone").clone()).attr("id",t),s.removeClass("hidden clone"),s.appendTo(o(".temps"))),s.find(".area span").text(a.deviceArea),s.find(".value").html(a.temperature+"&deg;"),s.find("i").attr("class","fa fa-thermometer-half "+a.cssClass)});var r=o("#verisure_device_select");r.find("button:not(.hidden)").remove(),o.each(e.customerImageCameras,function(e,a){var t=r.find("button.hidden").clone();t.data("device-label",a.deviceLabel),t.html(a.area),t.removeClass("hidden"),t.appendTo(r)})},complete:function(e){var a=n.updateInterval;429==e.status&&(a*=2,console.log(e.errorMessage)),n.updateIntervalId=window.setInterval(i.update,a),n.block.isLoading("hide")}})},set_arm_state:function(a){var e=o("#verisure_set_armstate #verisure_pin").val();o.ajax({url:"verisure/arm/"+a+"/"+(void 0!==e?e:""),success:function(e){showAlert("success","Alarm state changed"),o.fancybox.getInstance().close(),i.set_arm_state_buttons(a)},error:function(){showAlert("danger","Something went wrong")}})},set_arm_state_buttons:function(e){var a=n.block.find("#armstate button");switch(e){default:o("#verisure_set_armstate #arm_stay").addClass("hidden"),o("#verisure_set_armstate #arm_away").addClass("hidden"),o("#verisure_set_armstate #disarm").removeClass("hidden"),o("#verisure_set_armstate #current_stay").removeClass("hidden"),o("#verisure_set_armstate #current_away").addClass("hidden"),o("#verisure_set_armstate #current_disarmed").addClass("hidden"),a.attr("class","fa fa-verisure-stay text-warning");break;case"DISARMED":o("#verisure_set_armstate #arm_stay").removeClass("hidden"),o("#verisure_set_armstate #arm_away").removeClass("hidden"),o("#verisure_set_armstate #disarm").addClass("hidden"),o("#verisure_set_armstate #current_stay").addClass("hidden"),o("#verisure_set_armstate #current_away").addClass("hidden"),o("#verisure_set_armstate #current_disarmed").removeClass("hidden"),a.attr("class","fa fa-verisure-disarmed text-danger");break;case"ARMED_AWAY":o("#verisure_set_armstate #arm_stay").addClass("hidden"),o("#verisure_set_armstate #arm_away").addClass("hidden"),o("#verisure_set_armstate #disarm").removeClass("hidden"),o("#verisure_set_armstate #current_stay").addClass("hidden"),o("#verisure_set_armstate #current_away").removeClass("hidden"),o("#verisure_set_armstate #current_disarmed").addClass("hidden"),a.attr("class","fa fa-verisure-away text-success")}var t=new RegExp("_","g");a.attr("title",e.toLowerCase().capitalize().replace(t," "))},photos:function(a){a=void 0!==a&&a,o.ajax({url:"verisure/imageseries/",dataType:"json",success:function(e){var s;e&&(s=[],e.imageSeries.length&&n.block.find(".fa-camera").removeClass("hidden"),o.each(e.imageSeries,function(e,a){var t=new Date(a.image[0].captureTime),t=t.getDate()+"-"+zeropad(t.getMonth()+1,2)+"-"+t.getFullYear()+" "+zeropad(t.getHours(),2)+":"+zeropad(t.getMinutes(),2);s.push({src:"verisure/image/"+encodeURI(a.deviceLabel)+"/"+encodeURI(a.image[0].imageId)+"/"+encodeURI(a.image[0].captureTime),caption:a.area+" ("+t+")",deviceLabel:a.deviceLabel})}),s.sort(function(e,a){return e.caption>a.caption?-1:1}),a&&o.fancybox.open(s,{buttons:["take_photo","close"],slideClass:"verisure",loop:!0}))}})},take_photo:function(e){o.ajax({url:"verisure/captureimage/"+e,dataType:"json",success:function(e){o.fancybox.getInstance().close(),window.setTimeout(function(){o.ajax({url:"verisure/imageseries/",dataType:"json",success:function(e){n.block.find(".fa-camera").removeClass("hidden"),showAlert("success","photo taken")}})},1e4)},error:function(){showAlert("danger","Something went wrong")}})},select_device:function(){o.fancybox.open({src:"#verisure_device_select"})}};return i.initialize(),i}}(jQuery);;!function(r){r.fn.youless=function(e){var n=r.extend({block:this,updateInterval:1e3*this.data("updateinterval"),updateIntervalId:-1,refreshing:!1},e),t={initialize:function(){0!==n.block.length&&(n.block.on("click",".fa-sync",function(){clearInterval(n.updateIntervalId),n.updateIntervalId=setInterval(t.refresh,n.updateInterval),t.refresh()}),n.updateIntervalId=setInterval(t.refresh,n.updateInterval),t.refresh(!0))},refresh:function(e){n.refreshing||(n.refreshing=!0,(e=void 0!==e&&e)||n.block.isLoading(),r.ajax({url:"youless/",dataType:"json",success:function(e){n.block.find(".counter .value").text(e.counter),n.block.find(".power .value span").text(e.power),n.block.find(".power .value").attr("class","value "+e.class)},complete:function(){n.block.isLoading("hide"),n.refreshing=!1}}))}};return t.initialize(),t}}(jQuery);;var speedtest=!1,opcache=!1,pihole=!1,snmp=!1;function initializePlugins(){$(".sysinfo, .hardware, .harddisks, .processes").phpsysinfo(),$(".devices").devices(),$(".transmission").transmission(),$(".movies, .episodes, .albums, .couchpotato, .jellyfin").gallery(),$(".nowplaying").nowplaying(),$(".sickrage").sickrage(),$(".couchpotato").couchpotato(),$(".motion").motion(),speedtest=$(".speedtest").speedtest(),opcache=$(".opcache").opcache(),$(".youless").youless(),pihole=$(".pihole").pihole(),snmp=$(".snmp").snmp(),$(".verisure").verisure(),$(".roborock").roborock(),$(".cpu").rcpu(),$(".pulseway").pulseway(),$(".database-stats").database_stats(),$(".time:not(.delayed)").each(function(){initializeTinyTimer($(this))})}function initializeDashboardEventHandlers(){$(".toggle-collapse, .panel-heading h4").click(function(){var e=$(this).closest(".panel");0!==e.find(".toggle-collapse:visible").length&&(e.find(".toggle-collapse").toggleClass("fa-minus fa-plus"),e.find(".panel-body:eq(0)").toggleClass("hidden-xs"),e.hasClass("gallery")?e.css("height",e.find(".panel-body:eq(0)").hasClass("hidden-xs")?"auto":"379px"):!1!==opcache&&e.hasClass("opcache")?opcache.initializeChart():!1!==pihole&&e.hasClass("pihole")?pihole.initializeChart():!1!==speedtest&&e.hasClass("speedtest")&&speedtest.initUI(),e.find(".tab-content").length||e.find(".panel-body").length||e.find(".list-group").toggleClass("hidden-xs"))}),$("footer .toggle-all").click(function(){$(".fa-"+($(this).hasClass("fa-expand")?"plus":"minus")).trigger("click"),$(this).toggleClass("fa-expand fa-compress")})}function initializeTinyTimer(e){var s=new Date;s.setSeconds(s.getSeconds()-Math.floor(e.html())),e.tinyTimer({from:s,format:"%d days %0h:%0m:%0s"}).fadeIn()}$(function(){initializeDashboardEventHandlers(),initializePlugins()});